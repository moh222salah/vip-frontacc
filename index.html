<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
<meta name="description" content="VIP Front Accounting - Ù†Ø¸Ø§Ù… Ù…Ø­Ø§Ø³Ø¨ÙŠ ÙØ§Ø®Ø± Ù„Ù„Ø´Ø±ÙƒØ§Øª">
<meta name="theme-color" content="#004D40">
<title> ğŸ’ VIP FA  </title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800;900&family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<style>
/* ====================================================
   VIP FRONT ACCOUNTING â€” ELITE DESIGN SYSTEM v2.0
   ==================================================== */
:root {
  --primary:#00695C;--primary-light:#00897B;--primary-dark:#004D40;
  --gold:#D4AF37;--gold-light:#F0D060;--gold-dark:#A0800A;
  --emerald:#10B981;--purple:#7C3AED;--blue:#2563EB;--red:#EF4444;--amber:#F59E0B;
  --bg:#F0F4F8;--bg-card:#FFFFFF;--bg-sidebar:#0D1B2A;
  --text:#1A2332;--text2:#4A5568;--text3:#94A3B8;--text-inv:#FFFFFF;
  --border:rgba(0,105,92,0.12);--border2:rgba(0,0,0,0.06);
  --shadow-xs:0 1px 3px rgba(0,0,0,0.06);
  --shadow-sm:0 2px 8px rgba(0,0,0,0.08);
  --shadow-md:0 4px 16px rgba(0,77,64,0.12);
  --shadow-lg:0 8px 32px rgba(0,77,64,0.16);
  --shadow-xl:0 16px 48px rgba(0,77,64,0.2);
  --shadow-gold:0 8px 32px rgba(212,175,55,0.25);
  --glow:0 0 40px rgba(0,137,123,0.3);
  --glass:rgba(255,255,255,0.72);--glass-b:rgba(255,255,255,0.18);
  --grad-main:linear-gradient(135deg,#004D40 0%,#00695C 50%,#00897B 100%);
  --grad-gold:linear-gradient(135deg,#A0800A 0%,#D4AF37 50%,#F0D060 100%);
  --grad-card:linear-gradient(135deg,rgba(0,105,92,0.06) 0%,rgba(212,175,55,0.04) 100%);
  --r4:4px;--r8:8px;--r12:12px;--r16:16px;--r24:24px;--rfull:9999px;
  --dur:.25s;--ease:cubic-bezier(.4,0,.2,1);--ease-out:cubic-bezier(.19,1,.22,1);
  --font:'Tajawal',sans-serif;--font-en:'Inter',sans-serif;
  --sidebar-w:270px;--header-h:66px;
}
body.dark{
  --bg:#0A0F1A;--bg-card:#111827;--bg-sidebar:#060C14;
  --text:#F1F5F9;--text2:#CBD5E1;--text3:#64748B;
  --border:rgba(255,255,255,0.08);--border2:rgba(255,255,255,0.05);
  --glass:rgba(17,24,39,0.8);--glass-b:rgba(255,255,255,0.08);
  --shadow-md:0 4px 16px rgba(0,0,0,0.4);--shadow-lg:0 8px 32px rgba(0,0,0,0.5);
}
[dir=ltr]{--font:'Inter',sans-serif;}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
html{scroll-behavior:smooth;-webkit-text-size-adjust:100%;}
body{font-family:var(--font);background:var(--bg);color:var(--text);transition:background var(--dur) var(--ease),color var(--dur) var(--ease);overflow-x:hidden;-webkit-font-smoothing:antialiased;}

/* ======= SCROLLBAR ======= */
::-webkit-scrollbar{width:5px;height:5px;}
::-webkit-scrollbar-track{background:transparent;}
::-webkit-scrollbar-thumb{background:var(--primary);border-radius:var(--rfull);}

/* ======= HEADER ======= */
.header{
  position:fixed;inset:0 0 auto 0;height:var(--header-h);
  background:var(--grad-main);backdrop-filter:blur(30px);
  border-bottom:1px solid rgba(255,255,255,0.1);
  z-index:1000;display:flex;align-items:center;padding:0 1.25rem;
  box-shadow:var(--shadow-lg);
  animation:headerIn .5s var(--ease-out) both;
}
@keyframes headerIn{from{transform:translateY(-100%);opacity:0;}to{transform:none;opacity:1;}}
.header-inner{display:flex;align-items:center;width:100%;gap:1rem;}
.brand{display:flex;align-items:center;gap:.75rem;text-decoration:none;flex-shrink:0;}
.brand-icon{
  width:46px;height:46px;background:var(--grad-gold);border-radius:var(--r12);
  display:flex;align-items:center;justify-content:center;font-size:1.5rem;
  box-shadow:var(--shadow-gold);animation:floatIcon 3s ease-in-out infinite;
  border:2px solid rgba(255,255,255,0.2);
}
@keyframes floatIcon{0%,100%{transform:translateY(0);}50%{transform:translateY(-4px);}}
.brand-name{font-size:1.1rem;font-weight:800;color:#fff;letter-spacing:-.01em;}
.brand-sub{font-size:.65rem;color:rgba(255,255,255,.65);margin-top:1px;}

/* Search Bar */
.header-search{
  flex:1;max-width:520px;position:relative;
}
.search-bar-btn{
  width:100%;height:40px;background:rgba(255,255,255,0.13);
  border:1px solid rgba(255,255,255,0.2);border-radius:var(--rfull);
  display:flex;align-items:center;gap:.75rem;padding:0 1rem;
  cursor:pointer;transition:all var(--dur) var(--ease);color:rgba(255,255,255,.7);
  font-size:.85rem;font-family:var(--font);
}
.search-bar-btn:hover{background:rgba(255,255,255,.2);border-color:var(--gold);}
.search-bar-btn .kbd{
  margin-inline-start:auto;background:rgba(255,255,255,.15);
  border-radius:4px;padding:1px 6px;font-size:.7rem;color:rgba(255,255,255,.6);
}

/* Search Overlay */
.search-overlay{
  position:fixed;inset:0;z-index:3000;opacity:0;visibility:hidden;
  transition:all var(--dur) var(--ease);
}
.search-overlay.open{opacity:1;visibility:visible;}
.search-backdrop{position:absolute;inset:0;background:rgba(0,0,0,.6);backdrop-filter:blur(6px);}
.search-panel{
  position:absolute;top:0;left:50%;transform:translateX(-50%) translateY(-20px);
  width:min(700px,95vw);transition:transform var(--dur) var(--ease);
  padding-top:var(--header-h);
}
.search-overlay.open .search-panel{transform:translateX(-50%) translateY(0);}
.search-input-wrap{
  background:var(--bg-card);border-radius:var(--r16);overflow:hidden;
  box-shadow:var(--shadow-xl);border:1px solid var(--border);
}
.search-input-row{display:flex;align-items:center;gap:.75rem;padding:1rem 1.25rem;border-bottom:1px solid var(--border);}
.search-input-row svg{color:var(--text3);flex-shrink:0;}
#searchInput{
  flex:1;border:none;outline:none;font-size:1.05rem;font-family:var(--font);
  background:transparent;color:var(--text);
}
#searchInput::placeholder{color:var(--text3);}
.search-results{max-height:360px;overflow-y:auto;padding:.5rem;}
.search-item{
  display:flex;align-items:center;gap:.75rem;padding:.75rem 1rem;
  border-radius:var(--r8);cursor:pointer;transition:background var(--dur) var(--ease);
  color:var(--text);
}
.search-item:hover,.search-item.focused{background:var(--grad-card);}
.search-item-icon{width:36px;height:36px;border-radius:var(--r8);background:var(--grad-main);display:flex;align-items:center;justify-content:center;font-size:1rem;flex-shrink:0;}
.search-item-title{font-weight:600;font-size:.9rem;}
.search-item-sub{font-size:.75rem;color:var(--text3);}
.search-empty{text-align:center;padding:2rem;color:var(--text3);}

/* Header Actions */
.header-actions{display:flex;align-items:center;gap:.5rem;margin-inline-start:auto;}
.h-btn{
  width:40px;height:40px;border-radius:var(--r8);background:rgba(255,255,255,.1);
  border:1px solid rgba(255,255,255,.18);display:flex;align-items:center;justify-content:center;
  cursor:pointer;transition:all var(--dur) var(--ease);color:#fff;position:relative;
}
.h-btn:hover{background:rgba(255,255,255,.2);border-color:var(--gold);transform:translateY(-1px);}
.h-btn-badge{
  position:absolute;top:-4px;inset-inline-end:-4px;
  min-width:18px;height:18px;background:#EF4444;border-radius:var(--rfull);
  font-size:.6rem;font-weight:700;color:#fff;display:flex;align-items:center;justify-content:center;
  border:2px solid var(--primary);
}
.lang-btn{width:auto;padding:0 .75rem;gap:.4rem;font-size:.8rem;font-weight:700;}
.user-btn{
  display:flex;align-items:center;gap:.6rem;padding:0 .75rem;
  width:auto;border-radius:var(--rfull);
}
.user-avatar{width:30px;height:30px;border-radius:50%;background:var(--grad-gold);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.8rem;}
.user-name{font-size:.82rem;font-weight:600;}
.mobile-toggle{display:none;}
@media(max-width:1023px){
  .mobile-toggle{display:flex;}
  .header-search{display:none;}
}

/* ======= SIDEBAR ======= */
.sidebar{
  position:fixed;
  top:var(--header-h);
  right:0;                         /* RTL default: right side */
  width:var(--sidebar-w);
  height:calc(100vh - var(--header-h));
  background:var(--bg-sidebar);
  border-left:1px solid rgba(255,255,255,.05);
  overflow-y:auto;
  z-index:900;
  box-shadow:-4px 0 24px rgba(0,0,0,.2);
  transition:right .32s cubic-bezier(.19,1,.22,1);
}
/* LTR override */
[dir=ltr] .sidebar{
  right:auto;
  left:0;
  border-left:none;
  border-right:1px solid rgba(255,255,255,.05);
  box-shadow:4px 0 24px rgba(0,0,0,.2);
  transition:left .32s cubic-bezier(.19,1,.22,1);
}

/* â•â•â• MOBILE: HIDE SIDEBAR OFF-SCREEN â•â•â• */
@media(max-width:1023px){
  /* RTL â€” push sidebar to the RIGHT off screen */
  .sidebar{
    right: calc(-1 * var(--sidebar-w) - 30px);
  }
  .sidebar.open{
    right:0;
  }
  /* LTR â€” push sidebar to the LEFT off screen */
  [dir=ltr] .sidebar{
    left: calc(-1 * var(--sidebar-w) - 30px);
    right:auto;
  }
  [dir=ltr] .sidebar.open{
    left:0;
  }
}

/* â”€â”€ Sidebar Inner â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.sidebar-inner{padding:1.25rem 0 5rem;}
.nav-group{margin-bottom:1.5rem;}
.nav-group-title{
  font-size:.65rem;font-weight:700;letter-spacing:.12em;
  color:rgba(255,255,255,.3);text-transform:uppercase;
  padding:.25rem 1.25rem .5rem;
}
.nav-link{
  display:flex;align-items:center;gap:.85rem;padding:.7rem 1.25rem;
  color:rgba(255,255,255,.6);cursor:pointer;
  transition:all var(--dur) var(--ease);position:relative;
  font-size:.875rem;font-weight:500;border:none;background:none;
  width:100%;text-align:inherit;text-decoration:none;
}
.nav-link::after{
  content:'';position:absolute;right:0;top:0;bottom:0;width:3px;
  background:var(--grad-gold);transform:scaleY(0);
  transition:transform var(--dur) var(--ease);
}
[dir=ltr] .nav-link::after{right:auto;left:0;}
.nav-link:hover{background:rgba(0,137,123,.12);color:#fff;}
.nav-link:hover::after,.nav-link.active::after{transform:scaleY(1);}
.nav-link.active{background:var(--grad-main);color:#fff;box-shadow:var(--shadow-md);}
.nav-icon{width:20px;text-align:center;font-size:1rem;flex-shrink:0;}
.nav-text{flex:1;}
.nav-badge{
  padding:.1rem .45rem;background:#EF4444;border-radius:var(--rfull);
  font-size:.65rem;font-weight:700;color:#fff;
}

/* Overlay backdrop */
.sidebar-overlay{
  position:fixed;inset:0;background:rgba(0,0,0,.55);z-index:899;
  backdrop-filter:blur(4px);
  opacity:0;visibility:hidden;pointer-events:none;
  transition:opacity .3s var(--ease),visibility .3s;
}
.sidebar-overlay.open{opacity:1;visibility:visible;pointer-events:auto;}

/* ======= MAIN CONTENT ======= */
.main{
  margin-top:var(--header-h);
  margin-right:var(--sidebar-w);    /* RTL: space for sidebar on right */
  padding:1.75rem;
  min-height:calc(100vh - var(--header-h));
  animation:mainIn .6s var(--ease-out) both;
}
[dir=ltr] .main{
  margin-right:0;
  margin-left:var(--sidebar-w);    /* LTR: space for sidebar on left */
}
/* Mobile: full width, no margin */
@media(max-width:1023px){
  .main{
    margin-right:0 !important;
    margin-left:0 !important;
    padding:1rem;
  }
}
@keyframes mainIn{from{opacity:0;transform:translateY(16px);}to{opacity:1;transform:none;}}

/* ======= DASHBOARD ======= */
.page{display:none;}
.page.active{display:block;}

.page-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:1.5rem;flex-wrap:wrap;gap:1rem;}
.page-title{font-size:1.5rem;font-weight:800;}
.page-subtitle{font-size:.875rem;color:var(--text3);margin-top:.2rem;}
.page-actions{display:flex;gap:.5rem;}

/* Stats Grid */
.kpis{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1.25rem;margin-bottom:1.75rem;}
.kpi{
  background:var(--bg-card);border-radius:var(--r16);padding:1.25rem;
  border:1px solid var(--border);box-shadow:var(--shadow-sm);
  transition:all .3s var(--ease-out);cursor:default;
  position:relative;overflow:hidden;
}
.kpi::before{
  content:'';position:absolute;top:0;inset-inline-start:0;inset-inline-end:0;height:3px;
  background:var(--grad-main);transform:scaleX(0);transform-origin:start;
  transition:transform .4s var(--ease-out);
}
.kpi:hover{transform:translateY(-5px);box-shadow:var(--shadow-lg);}
.kpi:hover::before{transform:scaleX(1);}
.kpi-top{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:.875rem;}
.kpi-icon{
  width:48px;height:48px;border-radius:var(--r12);
  display:flex;align-items:center;justify-content:center;font-size:1.4rem;
  background:var(--grad-main);box-shadow:var(--shadow-md);
  transition:transform .4s var(--ease-out);
}
.kpi:hover .kpi-icon{transform:rotate(360deg) scale(1.05);}
.kpi-badge{
  padding:.25rem .6rem;border-radius:var(--rfull);font-size:.72rem;font-weight:700;
  display:flex;align-items:center;gap:.2rem;
}
.kpi-badge.up{background:rgba(16,185,129,.12);color:#059669;}
.kpi-badge.down{background:rgba(239,68,68,.12);color:#DC2626;}
.kpi-badge.warn{background:rgba(245,158,11,.12);color:#D97706;}
.kpi-val{font-size:1.75rem;font-weight:800;letter-spacing:-.02em;color:var(--text);}
.kpi-label{font-size:.8rem;color:var(--text3);margin-top:.15rem;}

/* Quick Actions */
.quick-actions{margin-bottom:1.75rem;}
.qa-title{font-size:1rem;font-weight:700;margin-bottom:.875rem;}
.qa-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(130px,1fr));gap:.875rem;}
.qa-item{
  background:var(--bg-card);border:1px solid var(--border);border-radius:var(--r12);
  padding:1.1rem .875rem;text-align:center;cursor:pointer;
  transition:all .3s var(--ease-out);display:flex;flex-direction:column;align-items:center;gap:.6rem;
}
.qa-item:hover{background:var(--grad-main);color:#fff;transform:translateY(-4px);box-shadow:var(--shadow-md);border-color:transparent;}
.qa-item:hover .qa-icon{transform:scale(1.15) rotate(-5deg);}
.qa-icon{font-size:1.75rem;transition:transform .3s var(--ease-out);}
.qa-label{font-size:.78rem;font-weight:600;color:var(--text2);}
.qa-item:hover .qa-label{color:rgba(255,255,255,.9);}

/* Charts Grid */
.charts-grid{display:grid;grid-template-columns:1fr 1fr;gap:1.25rem;margin-bottom:1.75rem;}
@media(max-width:900px){.charts-grid{grid-template-columns:1fr;}}
.chart-card{background:var(--bg-card);border-radius:var(--r16);padding:1.25rem;border:1px solid var(--border);box-shadow:var(--shadow-sm);}
.chart-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;}
.chart-title{font-size:.95rem;font-weight:700;}
.chart-wrap{position:relative;height:220px;}

/* Table Card */
.table-card{background:var(--bg-card);border-radius:var(--r16);border:1px solid var(--border);box-shadow:var(--shadow-sm);overflow:hidden;margin-bottom:1.25rem;}
.table-head{display:flex;align-items:center;justify-content:space-between;padding:1rem 1.25rem;border-bottom:1px solid var(--border);flex-wrap:wrap;gap:.5rem;}
.table-title{font-size:.95rem;font-weight:700;}
.table-wrap{overflow-x:auto;}
table{width:100%;border-collapse:collapse;}
th{background:var(--bg);font-size:.75rem;font-weight:700;color:var(--text3);padding:.75rem 1rem;text-align:inherit;white-space:nowrap;letter-spacing:.04em;text-transform:uppercase;}
td{padding:.875rem 1rem;font-size:.85rem;border-bottom:1px solid var(--border2);color:var(--text);}
tr:last-child td{border-bottom:none;}
tr:hover td{background:var(--grad-card);}
.tbody-empty{text-align:center;padding:3rem;color:var(--text3);}

/* ======= BUTTONS ======= */
.btn{
  display:inline-flex;align-items:center;gap:.5rem;padding:.55rem 1.1rem;
  border-radius:var(--r8);border:none;cursor:pointer;font-family:var(--font);
  font-size:.85rem;font-weight:600;transition:all var(--dur) var(--ease);
  position:relative;overflow:hidden;text-decoration:none;
}
.btn::after{
  content:'';position:absolute;inset:50% 50%;width:0;height:0;
  background:rgba(255,255,255,.25);border-radius:50%;transition:all .4s var(--ease);
  transform:translate(-50%,-50%);
}
.btn:hover::after,.btn:active::after{width:200%;height:200%;}
.btn-primary{background:var(--grad-main);color:#fff;box-shadow:var(--shadow-md);}
.btn-primary:hover{box-shadow:var(--shadow-lg);transform:translateY(-1px);}
.btn-gold{background:var(--grad-gold);color:#1a1a00;box-shadow:var(--shadow-gold);}
.btn-gold:hover{box-shadow:0 12px 40px rgba(212,175,55,.4);transform:translateY(-1px);}
.btn-outline{background:transparent;color:var(--primary);border:1.5px solid var(--primary);}
.btn-outline:hover{background:var(--primary);color:#fff;}
.btn-ghost{background:var(--bg);color:var(--text2);border:1px solid var(--border);}
.btn-ghost:hover{background:var(--grad-card);color:var(--text);}
.btn-danger{background:#EF4444;color:#fff;}
.btn-danger:hover{background:#DC2626;}
.btn-sm{padding:.35rem .8rem;font-size:.78rem;border-radius:var(--r8);}
.btn-icon{width:34px;height:34px;border-radius:var(--r8);padding:0;display:inline-flex;align-items:center;justify-content:center;background:var(--bg);border:1px solid var(--border);cursor:pointer;transition:all var(--dur) var(--ease);font-size:.95rem;}
.btn-icon:hover{background:var(--grad-main);color:#fff;border-color:transparent;transform:scale(1.05);}

/* ======= FORMS ======= */
.form-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:1rem;}
.form-full{grid-column:1/-1;}
.field{margin-bottom:1rem;}
.field label{display:block;font-size:.8rem;font-weight:600;color:var(--text2);margin-bottom:.4rem;}
.field-tip{font-size:.72rem;color:var(--text3);margin-top:.25rem;}
input,select,textarea{
  width:100%;padding:.6rem .875rem;border:1.5px solid var(--border);
  border-radius:var(--r8);background:var(--bg-card);color:var(--text);
  font-family:var(--font);font-size:.875rem;transition:all var(--dur) var(--ease);outline:none;
}
input:focus,select:focus,textarea:focus{border-color:var(--primary);box-shadow:0 0 0 3px rgba(0,105,92,.12);}
textarea{resize:vertical;min-height:90px;}
.input-group{position:relative;}
.input-prefix,.input-suffix{
  position:absolute;top:50%;transform:translateY(-50%);
  font-size:.85rem;color:var(--text3);pointer-events:none;
}
.input-prefix{inset-inline-start:.875rem;}
.input-suffix{inset-inline-end:.875rem;}
.input-group input{padding-inline-start:2.5rem;}
.input-group.has-suffix input{padding-inline-end:2.5rem;}

/* Status Badges */
.badge{display:inline-flex;align-items:center;gap:.3rem;padding:.25rem .65rem;border-radius:var(--rfull);font-size:.72rem;font-weight:700;}
.badge-green{background:rgba(16,185,129,.12);color:#059669;}
.badge-red{background:rgba(239,68,68,.12);color:#DC2626;}
.badge-amber{background:rgba(245,158,11,.12);color:#D97706;}
.badge-blue{background:rgba(37,99,235,.12);color:#1D4ED8;}
.badge-purple{background:rgba(124,58,237,.12);color:#6D28D9;}

/* ======= MODAL SYSTEM ======= */
.modal-backdrop{
  position:fixed;inset:0;background:rgba(0,0,0,.65);backdrop-filter:blur(10px);
  z-index:2000;opacity:0;visibility:hidden;transition:all .2s var(--ease);
}
.modal-backdrop.open{opacity:1;visibility:visible;}
.modal{
  position:fixed;inset-inline-end:-100%;top:0;bottom:0;
  width:min(92vw,900px);background:var(--bg-card);z-index:2001;
  display:flex;flex-direction:column;
  box-shadow:-20px 0 60px rgba(0,0,0,.2);
  transition:inset-inline-end .35s var(--ease-out);overflow:hidden;
}
[dir=ltr] .modal{inset-inline-end:auto;inset-inline-start:-100%;transition:inset-inline-start .35s var(--ease-out);}
.modal-backdrop.open .modal{inset-inline-end:0;}
[dir=ltr] .modal-backdrop.open .modal{inset-inline-start:0;}
.modal-hdr{
  background:var(--grad-main);padding:1rem 1.25rem;
  display:flex;align-items:center;justify-content:space-between;flex-shrink:0;
}
.modal-hdr-title{font-size:1.1rem;font-weight:700;color:#fff;display:flex;align-items:center;gap:.6rem;}
.modal-hdr-close{
  width:36px;height:36px;background:rgba(255,255,255,.15);border:none;border-radius:var(--r8);
  color:#fff;font-size:1.1rem;cursor:pointer;transition:all var(--dur) var(--ease);
  display:flex;align-items:center;justify-content:center;
}
.modal-hdr-close:hover{background:rgba(255,255,255,.25);transform:rotate(90deg);}
.modal-toolbar{
  padding:.75rem 1.25rem;border-bottom:1px solid var(--border);
  display:flex;align-items:center;gap:.5rem;flex-wrap:wrap;background:var(--bg);flex-shrink:0;
}
.modal-body{flex:1;overflow-y:auto;padding:1.25rem;}
.modal-footer{
  padding:.875rem 1.25rem;border-top:1px solid var(--border);
  display:flex;justify-content:flex-end;gap:.5rem;background:var(--bg);flex-shrink:0;
}

/* ======= TOAST ======= */
.toast-wrap{position:fixed;bottom:1.5rem;inset-inline-start:1.5rem;z-index:5000;display:flex;flex-direction:column;gap:.5rem;}
.toast{
  display:flex;align-items:center;gap:.75rem;padding:.75rem 1rem;
  background:var(--bg-card);border-radius:var(--r12);box-shadow:var(--shadow-xl);
  border-inline-start:3px solid var(--primary);min-width:260px;max-width:360px;
  transform:translateX(-120%);transition:transform .3s var(--ease-out);font-size:.85rem;
}
[dir=ltr] .toast{transform:translateX(-120%);}
.toast.show{transform:none;}
.toast-icon{font-size:1.2rem;flex-shrink:0;}
.toast-msg{flex:1;font-weight:500;}
.toast-close{background:none;border:none;color:var(--text3);cursor:pointer;font-size:1rem;}
.toast.success{border-color:var(--emerald);}
.toast.error{border-color:var(--red);}
.toast.warn{border-color:var(--amber);}
.toast.info{border-color:var(--blue);}

/* ======= INVOICE FORM ======= */
.inv-lines{border:1px solid var(--border);border-radius:var(--r12);overflow:hidden;margin-bottom:1rem;}
.inv-lines-head{display:grid;grid-template-columns:2fr 1fr 1fr 1fr auto;gap:.5rem;padding:.5rem .875rem;background:var(--bg);font-size:.72rem;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.05em;}
.inv-line{display:grid;grid-template-columns:2fr 1fr 1fr 1fr auto;gap:.5rem;padding:.5rem .875rem;border-top:1px solid var(--border2);align-items:center;}
.inv-line input{border-color:transparent;background:transparent;padding:.35rem .5rem;}
.inv-line input:focus{background:var(--bg-card);border-color:var(--primary);}
.inv-totals{padding:1rem 1.25rem;border-top:2px solid var(--border);display:flex;flex-direction:column;align-items:flex-end;gap:.4rem;}
.inv-total-row{display:flex;gap:3rem;font-size:.875rem;}
.inv-total-row.grand{font-size:1.1rem;font-weight:800;color:var(--primary);}

/* ======= REPORT STYLES ======= */
.report-filters{display:flex;gap:.75rem;flex-wrap:wrap;margin-bottom:1.25rem;align-items:flex-end;}
.report-card{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--r16);overflow:hidden;margin-bottom:1.25rem;}
.report-card-head{padding:1rem 1.25rem;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;}
.report-section{margin-bottom:1.5rem;}
.report-section-title{font-size:.8rem;font-weight:700;text-transform:uppercase;letter-spacing:.08em;color:var(--text3);padding:.5rem 1rem;background:var(--bg);border-bottom:1px solid var(--border);}
.report-row{display:flex;justify-content:space-between;padding:.65rem 1rem;border-bottom:1px solid var(--border2);font-size:.85rem;}
.report-row.subtotal{background:rgba(0,105,92,.04);font-weight:700;}
.report-row.total{background:var(--grad-main);color:#fff;font-weight:800;font-size:.95rem;}
.report-row.indent{padding-inline-start:2.5rem;color:var(--text2);}

/* ======= INVENTORY ======= */
.inv-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:1rem;}
.inv-card{
  background:var(--bg-card);border:1px solid var(--border);border-radius:var(--r16);
  padding:1.1rem;transition:all .3s var(--ease-out);cursor:pointer;
}
.inv-card:hover{transform:translateY(-4px);box-shadow:var(--shadow-lg);}
.inv-card-icon{font-size:2.5rem;margin-bottom:.6rem;}
.inv-card-name{font-weight:700;font-size:.9rem;margin-bottom:.25rem;}
.inv-card-sku{font-size:.72rem;color:var(--text3);margin-bottom:.6rem;}
.inv-card-stock{display:flex;align-items:center;justify-content:space-between;}
.stock-bar-wrap{height:4px;background:var(--border);border-radius:2px;flex:1;margin-inline-end:.5rem;overflow:hidden;}
.stock-bar{height:100%;border-radius:2px;background:var(--grad-main);transition:width .6s var(--ease-out);}
.stock-num{font-size:.72rem;font-weight:700;}

/* ======= CTA FLOATING ======= */
.cta-float{
  position:fixed;bottom:1.5rem;inset-inline-start:1.5rem;
  display:flex;gap:.75rem;z-index:1500;
  animation:floatUp .6s .8s var(--ease-out) both;
}
@keyframes floatUp{from{transform:translateY(60px);opacity:0;}to{transform:none;opacity:1;}}
.cta-float .btn{border-radius:var(--rfull);padding:.65rem 1.25rem;font-size:.82rem;}
@media(max-width:640px){.cta-float{inset-inline-start:.75rem;bottom:.75rem;flex-direction:column;gap:.4rem;}
.cta-float .btn span{display:none;}
.cta-float .btn{padding:.65rem;width:46px;height:46px;justify-content:center;}}

/* ======= BACK TO TOP ======= */
.btt{
  position:fixed;bottom:1.5rem;inset-inline-end:1.5rem;z-index:1500;
  width:44px;height:44px;border-radius:50%;background:var(--grad-main);
  border:none;color:#fff;cursor:pointer;box-shadow:var(--shadow-md);
  opacity:0;visibility:hidden;transform:translateY(10px);
  transition:all var(--dur) var(--ease);display:flex;align-items:center;justify-content:center;
}
.btt.show{opacity:1;visibility:visible;transform:none;}
.btt:hover{box-shadow:var(--shadow-lg),var(--glow);transform:translateY(-3px);}

/* ======= ONBOARDING ======= */
.onboard-wrap{
  position:fixed;inset:0;z-index:4000;display:flex;align-items:center;justify-content:center;
  background:rgba(0,0,0,.75);backdrop-filter:blur(12px);
  opacity:0;visibility:hidden;pointer-events:none;
  transition:opacity .35s var(--ease),visibility .35s;
}
.onboard-wrap.show{opacity:1;visibility:visible;pointer-events:auto;}
.onboard-card{
  background:var(--bg-card);border-radius:var(--r24);padding:2rem 2rem 1.75rem;
  width:min(520px,92vw);box-shadow:var(--shadow-xl);
  border:1px solid var(--border);
  transform:scale(.92) translateY(16px);
  transition:transform .4s var(--ease-out);
  min-height:auto;
}
.onboard-wrap.show .onboard-card{transform:none;}
.onboard-step{display:none;animation:fadeSlide .3s var(--ease-out);}
.onboard-step.active{display:block;}
@keyframes fadeSlide{from{opacity:0;transform:translateY(10px);}to{opacity:1;transform:none;}}
.onboard-icon{font-size:3.5rem;margin-bottom:.875rem;text-align:center;line-height:1;}
.onboard-progress{display:flex;gap:.4rem;margin-bottom:1.25rem;}
.op-dot{height:4px;flex:1;border-radius:2px;background:var(--border);transition:background .3s;}
.op-dot.done{background:var(--grad-main);}
.setup-form .field{margin-bottom:.875rem;}
/* Dismiss button top-right */
.onboard-dismiss{
  position:absolute;top:1rem;inset-inline-end:1rem;
  width:32px;height:32px;border-radius:50%;background:var(--bg);
  border:1px solid var(--border);color:var(--text3);
  cursor:pointer;display:flex;align-items:center;justify-content:center;
  font-size:.9rem;transition:all var(--dur) var(--ease);
}
.onboard-dismiss:hover{background:var(--red);color:#fff;border-color:transparent;transform:rotate(90deg);}
.onboard-card-inner{position:relative;}

/* ======= KEYBOARD SHORTCUT HELP ======= */
.shortcut-overlay{
  position:fixed;inset:0;z-index:4500;display:flex;align-items:center;justify-content:center;
  background:rgba(0,0,0,.65);backdrop-filter:blur(8px);
  opacity:0;visibility:hidden;transition:all .2s var(--ease);
}
.shortcut-overlay.open{opacity:1;visibility:visible;}
.shortcut-card{
  background:var(--bg-card);border-radius:var(--r24);padding:1.75rem;
  width:min(520px,90vw);max-height:80vh;overflow-y:auto;box-shadow:var(--shadow-xl);
}
.shortcut-row{display:flex;align-items:center;justify-content:space-between;padding:.5rem 0;border-bottom:1px solid var(--border2);font-size:.875rem;}
kbd{
  background:var(--bg);border:1px solid var(--border);border-radius:4px;
  padding:.15rem .4rem;font-size:.75rem;font-family:monospace;color:var(--text2);
}

/* ======= MISC ======= */
.empty-state{text-align:center;padding:3rem 1rem;}
.empty-icon{font-size:3.5rem;margin-bottom:1rem;}
.empty-title{font-size:1.1rem;font-weight:700;margin-bottom:.5rem;}
.empty-desc{font-size:.875rem;color:var(--text3);margin-bottom:1.25rem;}
ØµÙ„Ø§Ø­ ider{height:1px;background:var(--border);margin:1rem 0;}
.tag{display:inline-block;padding:.15rem .5rem;border-radius:var(--r4);font-size:.72rem;font-weight:600;background:var(--grad-card);border:1px solid var(--border);}
.avatar{width:36px;height:36px;border-radius:50%;background:var(--grad-main);display:flex;align-items:center;justify-content:center;font-size:.85rem;font-weight:700;color:#fff;flex-shrink:0;}

/* Progress bar */
.prog-wrap{height:6px;background:var(--border);border-radius:3px;overflow:hidden;}
.prog-bar{height:100%;background:var(--grad-main);border-radius:3px;transition:width .6s var(--ease-out);}

/* Tooltip */
[data-tip]{position:relative;}
[data-tip]::before{
  content:attr(data-tip);position:absolute;bottom:calc(100% + 6px);left:50%;transform:translateX(-50%);
  background:rgba(0,0,0,.8);color:#fff;padding:.3rem .6rem;border-radius:var(--r4);font-size:.72rem;
  white-space:nowrap;pointer-events:none;opacity:0;transition:opacity .2s;z-index:100;
}
[data-tip]:hover::before{opacity:1;}

/* Animations helpers */
.fade-in{animation:fadeIn .5s var(--ease-out);}
@keyframes fadeIn{from{opacity:0;}to{opacity:1;}}
.slide-up{animation:mainIn .4s var(--ease-out);}

/* RTL fix for table */
[dir=rtl] th,[dir=rtl] td{text-align:right;}
[dir=ltr] .nav-link::after{right:0;left:auto;border-radius:0 2px 2px 0;}
[dir=ltr] .kpi::before{transform-origin:end;}
[dir=ltr] .sidebar{box-shadow:4px 0 24px rgba(0,0,0,.15);}

/* Print */
@media print{.header,.sidebar,.cta-float,.btt,.toast-wrap,.modal-backdrop{display:none!important;}
.main{margin:0!important;padding:1rem!important;}}
@media(prefers-reduced-motion:reduce){*,*::before,*::after{animation:none!important;transition-duration:.01ms!important;}}
</style>
</head>
<body>

   
<!-- ========== HEADER ========== -->
<header class="header" id="header">
  <div class="header-inner">
    <a class="brand" href="#" onclick="showPage('dashboard'); return false;">
      <div class="brand-icon">ğŸ’</div>
      <div class="brand-text-wrapper">
        <div class="brand-name" data-ar="VIP FA" data-en="VIP FA">VIP FA</div>
        <div class="brand-sub" data-ar="Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…" data-en="Dashboard">Dashboard</div>
      </div>
    </a>
  
           
    <!-- Search trigger -->
    <div class="header-search">
      <button class="search-bar-btn" id="searchTrigger" data-tip="Ctrl+K">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
        <span data-ar="Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…..." data-en="Search system...">Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…...</span>
        <span class="kbd">Ctrl+K</span>
      </button>
    </div>

    <div class="header-actions">
      <button class="h-btn" id="themeBtn" data-tip="Dark Mode">ğŸŒ™</button>
      <button class="h-btn lang-btn" id="langBtn">
        <span id="langLabel">EN</span>
      </button>
      
      <button class="h-btn user-btn">
        <div class="user-avatar">Ù…</div>
        <span class="user-name" data-ar="Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­ " data-en="Mohamed Salah">Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­</span>
      </button>
      <button class="h-btn mobile-toggle" id="mobileToggle">â˜°</button>
    </div>
  </div>
</header>

<!-- ========== SEARCH OVERLAY ========== -->
<div class="search-overlay" id="searchOverlay">
  <div class="search-backdrop" id="searchBackdrop"></div>
  <div class="search-panel">
    <div class="search-input-wrap">
      <div class="search-input-row">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
        <input id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù…ÙŠÙ„ØŒ ÙØ§ØªÙˆØ±Ø©ØŒ Ù…Ù†ØªØ¬..." autocomplete="off">
        <button class="btn-icon btn-sm" onclick="closeSearch()">âœ•</button>
      </div>
      <div class="search-results" id="searchResults"></div>
    </div>
  </div>
</div>

<!-- ========== SIDEBAR ========== -->
<aside class="sidebar" id="sidebar">
  <div class="sidebar-inner" id="sidebarInner"></div>
</aside>
<div class="sidebar-overlay" id="sidebarOverlay" onclick="closeSidebar()"></div>

<!-- ========== MAIN CONTENT ========== -->
<main class="main" id="main">

  <!-- DASHBOARD PAGE -->
  <div class="page active" id="page-dashboard">
    <div class="page-header">
      <div>
        <h1 class="page-title" data-ar="Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…" data-en="Dashboard">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h1>
        <p class="page-subtitle" data-ar="Ù…Ø±Ø­Ø¨Ø§Ù‹ Ù…Ø­Ù…Ø¯ØŒ Ø¥Ù„ÙŠÙƒ Ù…Ù„Ø®Øµ Ø§Ù„ÙŠÙˆÙ…" data-en="Welcome Mohamed, here's today's summary">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ù…Ø­Ù…Ø¯ØŒ Ø¥Ù„ÙŠÙƒ Ù…Ù„Ø®Øµ Ø§Ù„ÙŠÙˆÙ…</p>
      </div>
      <div class="page-actions">
        <button class="btn btn-primary" onclick="showToast('success','ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª','âœ“')">
          <span>ğŸ”„</span> <span data-ar="ØªØ­Ø¯ÙŠØ«" data-en="Refresh">ØªØ­Ø¯ÙŠØ«</span>
        </button>
        <button class="btn btn-gold" onclick="openPage('salesInvoices')">
          <span>â•</span> <span data-ar="ÙØ§ØªÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©" data-en="New Invoice">ÙØ§ØªÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©</span>
        </button>
      </div>
    </div>

    <!-- KPIs -->
    <div class="kpis" id="kpis"></div>

    <!-- Quick Actions -->
    <div class="quick-actions">
      <h2 class="qa-title" data-ar="Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø©" data-en="Quick Actions">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø©</h2>
      <div class="qa-grid" id="qaGrid"></div>
    </div>

    <!-- Charts -->
    <div class="charts-grid">
      <div class="chart-card">
        <div class="chart-head">
          <span class="chart-title" data-ar="Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©" data-en="Monthly Revenue">Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</span>
          <button class="btn btn-ghost btn-sm" data-ar="6 Ø£Ø´Ù‡Ø±" data-en="6 Months">6 Ø£Ø´Ù‡Ø±</button>
        </div>
        <div class="chart-wrap"><canvas id="revenueChart"></canvas></div>
      </div>
      <div class="chart-card">
        <div class="chart-head">
          <span class="chart-title" data-ar="ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª" data-en="Sales Distribution">ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</span>
          <button class="btn btn-ghost btn-sm" data-ar="Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±" data-en="This Month">Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±</button>
        </div>
        <div class="chart-wrap"><canvas id="salesChart"></canvas></div>
      </div>
    </div>

    <!-- Recent Transactions -->
    <div class="table-card">
      <div class="table-head">
        <span class="table-title" data-ar="Ø¢Ø®Ø± Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª" data-en="Recent Transactions">Ø¢Ø®Ø± Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</span>
        <button class="btn btn-ghost btn-sm" onclick="openPage('salesInvoices')" data-ar="Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„" data-en="View All">Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</button>
      </div>
      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th data-ar="Ø§Ù„Ø±Ù‚Ù…" data-en="Number">Ø§Ù„Ø±Ù‚Ù…</th>
              <th data-ar="Ø§Ù„Ø¹Ù…ÙŠÙ„ / Ø§Ù„Ù…ÙˆØ±Ø¯" data-en="Customer / Supplier">Ø§Ù„Ø¹Ù…ÙŠÙ„ / Ø§Ù„Ù…ÙˆØ±Ø¯</th>
              <th data-ar="Ø§Ù„Ù†ÙˆØ¹" data-en="Type">Ø§Ù„Ù†ÙˆØ¹</th>
              <th data-ar="Ø§Ù„Ù…Ø¨Ù„Øº" data-en="Amount">Ø§Ù„Ù…Ø¨Ù„Øº</th>
              <th data-ar="Ø§Ù„ØªØ§Ø±ÙŠØ®" data-en="Date">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
              <th data-ar="Ø§Ù„Ø­Ø§Ù„Ø©" data-en="Status">Ø§Ù„Ø­Ø§Ù„Ø©</th>
              <th data-ar="Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª" data-en="Actions">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
            </tr>
          </thead>
          <tbody id="txTable"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- OTHER PAGES (dynamically shown) -->
  <div class="page" id="page-modal">
    <div id="modalPageContent"></div>
  </div>

</main>

<!-- ========== MODAL SYSTEM ========== -->
<div class="modal-backdrop" id="modalBackdrop">
  <div class="modal" id="modalPanel">
    <div class="modal-hdr" id="modalHdr">
      <span class="modal-hdr-title" id="modalTitle">...</span>
      <button class="modal-hdr-close" onclick="closeModal()">âœ•</button>
    </div>
    <div class="modal-toolbar" id="modalToolbar"></div>
    <div class="modal-body" id="modalBody"></div>
    <div class="modal-footer" id="modalFooter"></div>
  </div>
</div>

<!-- ========== TOAST ========== -->
<div class="toast-wrap" id="toastWrap"></div>

<!-- ========== BTT ========== -->
<button class="btt" id="btt" onclick="scrollTo({top:0,behavior:'smooth'})">â†‘</button>

<!-- ========== CTA FLOATING ========== -->
<div class="cta-float">
  <a href="https://moh222salah.github.io/cv" target="_blank" class="btn btn-primary">
    <span>ğŸŒ</span><span data-ar="Ù…Ù„Ù Ø§Ù„Ø£Ø¹Ù…Ø§Ù„" data-en="Portfolio">Ù…Ù„Ù Ø§Ù„Ø£Ø¹Ù…Ø§Ù„</span>
  </a>
  <a href="https://wa.me/201113903070" target="_blank" class="btn btn-gold">
    <span>ğŸ’¬</span><span data-ar="ÙˆØ§ØªØ³Ø§Ø¨" data-en="WhatsApp">ÙˆØ§ØªØ³Ø§Ø¨</span>
  </a>
</div>

<!-- ========== ONBOARDING ========== -->
<div class="onboard-wrap" id="onboardWrap">
  <div class="onboard-card">
    <div class="onboard-card-inner">
      <button class="onboard-dismiss" id="onboardDismiss" onclick="finishOnboarding()" title="ØªØ®Ø·ÙŠ / Skip">âœ•</button>
      <div class="onboard-progress" id="onboardProgress"></div>
      <div id="onboardContent"></div>
    </div>
  </div>
</div>

<!-- ========== SHORTCUT HELP ========== -->
<div class="shortcut-overlay" id="shortcutOverlay" onclick="closeShortcuts(event)">
  <div class="shortcut-card" onclick="event.stopPropagation()">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:1rem;">
      <h3 data-ar="Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­" data-en="Keyboard Shortcuts">Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­</h3>
      <button class="btn-icon" onclick="closeShortcuts()">âœ•</button>
    </div>
    <div class="shortcut-row"><span data-ar="ÙØªØ­ Ø§Ù„Ø¨Ø­Ø«" data-en="Open Search">ÙØªØ­ Ø§Ù„Ø¨Ø­Ø«</span><kbd>Ctrl + K</kbd></div>
    <div class="shortcut-row"><span data-ar="ÙØ§ØªÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©" data-en="New Invoice">ÙØ§ØªÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©</span><kbd>Ctrl + N</kbd></div>
    <div class="shortcut-row"><span data-ar="Ø­ÙØ¸" data-en="Save">Ø­ÙØ¸</span><kbd>Ctrl + S</kbd></div>
    <div class="shortcut-row"><span data-ar="Ø·Ø¨Ø§Ø¹Ø©" data-en="Print">Ø·Ø¨Ø§Ø¹Ø©</span><kbd>Ctrl + P</kbd></div>
    <div class="shortcut-row"><span data-ar="Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…" data-en="Dashboard">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</span><kbd>Alt + D</kbd></div>
    <div class="shortcut-row"><span data-ar="Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©" data-en="This menu">Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</span><kbd>Ctrl + /</kbd></div>
    <div class="shortcut-row"><span data-ar="Ø¥ØºÙ„Ø§Ù‚ / Ø±Ø¬ÙˆØ¹" data-en="Close / Back">Ø¥ØºÙ„Ø§Ù‚ / Ø±Ø¬ÙˆØ¹</span><kbd>Esc</kbd></div>
    <div class="shortcut-row"><span data-ar="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù„ØºØ©" data-en="Toggle Language">ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù„ØºØ©</span><kbd>Alt + L</kbd></div>
  </div>
</div>

<script>
/* =============================================
   VIP FRONT ACCOUNTING â€” ENGINE v2.0
   ============================================= */

// â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const S = {
  lang: localStorage.getItem('vfa-lang') || (navigator.language.startsWith('ar') ? 'ar' : 'en'),
  dark: localStorage.getItem('vfa-dark') === '1',
  onboarded: localStorage.getItem('vfa-onboarded') === '1',
  activePage: 'dashboard',
  charts: {},
};

// â”€â”€ SIDEBAR MENU â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const MENU = [
  { group: { ar:'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', en:'Main' }, items:[
    { id:'dashboard', ar:'Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…', en:'Dashboard', icon:'ğŸ“Š' },
  ]},
  { group:{ ar:'Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©', en:'Accounting' }, items:[
    { id:'chartOfAccounts', ar:'Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª', en:'Chart of Accounts', icon:'ğŸ“‹' },
    { id:'journalEntries',  ar:'Ø§Ù„Ù‚ÙŠÙˆØ¯ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©', en:'Journal Entries',  icon:'ğŸ“', badge:2 },
    { id:'trialBalance',    ar:'Ù…ÙŠØ²Ø§Ù† Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', en:'Trial Balance',    icon:'âš–ï¸' },
    { id:'financialReports',ar:'Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©',en:'Financial Reports',icon:'ğŸ“ˆ' },
  ]},
  { group:{ ar:'Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª', en:'Sales' }, items:[
    { id:'customers',     ar:'Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡',        en:'Customers',      icon:'ğŸ‘¥' },
    { id:'salesInvoices', ar:'ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª', en:'Sales Invoices', icon:'ğŸ§¾', badge:5 },
    { id:'salesReturns',  ar:'Ù…Ø±Ø¯ÙˆØ¯Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª',en:'Sales Returns',  icon:'â†©ï¸' },
    { id:'receipts',      ar:'Ø³Ù†Ø¯Ø§Øª Ø§Ù„Ù‚Ø¨Ø¶',    en:'Receipts',       icon:'ğŸ’µ' },
  ]},
  { group:{ ar:'Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª', en:'Purchases' }, items:[
    { id:'suppliers',        ar:'Ø§Ù„Ù…ÙˆØ±Ø¯ÙˆÙ†',         en:'Suppliers',         icon:'ğŸ­' },
    { id:'purchaseInvoices', ar:'ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª', en:'Purchase Invoices', icon:'ğŸ“¦' },
    { id:'purchaseReturns',  ar:'Ù…Ø±Ø¯ÙˆØ¯Ø§Øª Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª',en:'Purchase Returns',  icon:'ğŸ”„' },
    { id:'payments',         ar:'Ø³Ù†Ø¯Ø§Øª Ø§Ù„ØµØ±Ù',      en:'Payments',         icon:'ğŸ’³' },
  ]},
  { group:{ ar:'Ø§Ù„Ù…Ø®Ø²ÙˆÙ†', en:'Inventory' }, items:[
    { id:'products',      ar:'Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª',    en:'Products',       icon:'ğŸ“¦' },
    { id:'stockMovement', ar:'Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ø®Ø²ÙˆÙ†',en:'Stock Movement', icon:'ğŸ”€' },
    { id:'warehouseRpt',  ar:'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø®Ø²Ù†',en:'Warehouse Rpt',  icon:'ğŸª' },
  ]},
  { group:{ ar:'Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', en:'Settings' }, items:[
    { id:'company',    ar:'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø±ÙƒØ©', en:'Company Info', icon:'ğŸ¢' },
    { id:'currencies', ar:'Ø§Ù„Ø¹Ù…Ù„Ø§Øª',       en:'Currencies',   icon:'ğŸ’±' },
    { id:'users',      ar:'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†',    en:'Users',        icon:'ğŸ‘¤' },
  ]},
];

// â”€â”€ SEARCH DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const SEARCH_DATA = [
  { label:{ar:'Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…',en:'Dashboard'}, sub:{ar:'Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©',en:'Main page'}, icon:'ğŸ“Š', action:()=>showPage('dashboard') },
  { label:{ar:'ÙØ§ØªÙˆØ±Ø© Ù…Ø¨ÙŠØ¹Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©',en:'New Sales Invoice'}, sub:{ar:'Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø©',en:'Create invoice'}, icon:'ğŸ§¾', action:()=>openPage('salesInvoices') },
  { label:{ar:'Ø´Ø±ÙƒØ© Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©',en:'Elite Trading Co.'}, sub:{ar:'Ø¹Ù…ÙŠÙ„ â€” Ø±ØµÙŠØ¯ 85,500 Ø±.Ø³',en:'Customer â€” Balance SAR 85,500'}, icon:'ğŸ‘¥', action:()=>openPage('customers') },
  { label:{ar:'Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª',en:'Chart of Accounts'}, sub:{ar:'Ø´Ø¬Ø±Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠØ©',en:'Accounting chart'}, icon:'ğŸ“‹', action:()=>openPage('chartOfAccounts') },
  { label:{ar:'Ù…ÙŠØ²Ø§Ù† Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©',en:'Trial Balance'}, sub:{ar:'ØªÙ‚Ø±ÙŠØ± - Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙŠÙˆÙ…',en:'Report â€” updated today'}, icon:'âš–ï¸', action:()=>openPage('trialBalance') },
  { label:{ar:'Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª',en:'Products'}, sub:{ar:'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ† ÙˆØ§Ù„Ù…Ù†ØªØ¬Ø§Øª',en:'Manage inventory'}, icon:'ğŸ“¦', action:()=>openPage('products') },
  { label:{ar:'Ø§Ù„Ù‚ÙŠÙˆØ¯ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©',en:'Journal Entries'}, sub:{ar:'2 Ù‚ÙŠØ¯ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©',en:'2 entries under review'}, icon:'ğŸ“', action:()=>openPage('journalEntries') },
  { label:{ar:'Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©',en:'Financial Reports'}, sub:{ar:'P&L, Balance Sheet, Cash Flow',en:'P&L, Balance Sheet, Cash Flow'}, icon:'ğŸ“ˆ', action:()=>openPage('financialReports') },
];

// â”€â”€ KPI DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const KPI_DATA = [
  { icon:'ğŸ’°', ar:'Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„ÙŠÙˆÙ…',    en:'Today Revenue',     val:'SAR 12,450', badge:'+12%', type:'up' },
  { icon:'ğŸ“Š', ar:'Ø§Ù„Ø°Ù…Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©',    en:'Accounts Receivable',val:'SAR 245,800',badge:'-5%',  type:'down' },
  { icon:'âš ï¸', ar:'Ù…Ù†ØªØ¬Ø§Øª Ù…Ù†Ø®ÙØ¶Ø©',   en:'Low Stock Items',    val:'8',          badge:'ØªØ­Ø°ÙŠØ±',type:'warn' },
  { icon:'ğŸ”„', ar:'Ø·Ù„Ø¨Ø§Øª Ù…Ø¹Ù„Ù‚Ø©',      en:'Pending Orders',     val:'23',         badge:'+3',   type:'up' },
  { icon:'ğŸ’³', ar:'Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª Ø§Ù„ÙŠÙˆÙ…', en:'Today Payments',     val:'SAR 8,200',  badge:'+8%',  type:'up' },
  { icon:'ğŸ“¦', ar:'Ø­Ø±ÙƒØ© Ù…Ø®Ø²ÙˆÙ†',      en:'Stock Movements',    val:'47',         badge:'Ø§Ù„ÙŠÙˆÙ…',type:'up' },
];

// â”€â”€ QUICK ACTIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const QA_DATA = [
  { icon:'ğŸ§¾', ar:'ÙØ§ØªÙˆØ±Ø© Ù…Ø¨ÙŠØ¹Ø§Øª', en:'Sales Invoice',  fn:()=>openPage('salesInvoices') },
  { icon:'ğŸ’µ', ar:'Ø³Ù†Ø¯ Ù‚Ø¨Ø¶',        en:'Receipt',        fn:()=>openPage('receipts') },
  { icon:'ğŸ‘¤', ar:'Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯',      en:'New Customer',   fn:()=>openPage('customers') },
  { icon:'ğŸ“¦', ar:'Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø®Ø²ÙˆÙ†',    en:'Stock Entry',    fn:()=>openPage('stockMovement') },
  { icon:'ğŸ“', ar:'Ù‚ÙŠØ¯ ÙŠÙˆÙ…ÙŠØ©',      en:'Journal Entry',  fn:()=>openPage('journalEntries') },
  { icon:'ğŸ“Š', ar:'Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±',       en:'Reports',        fn:()=>openPage('financialReports') },
  { icon:'ğŸ›’', ar:'ÙØ§ØªÙˆØ±Ø© Ù…Ø´ØªØ±ÙŠØ§Øª',en:'Purchase Inv.',  fn:()=>openPage('purchaseInvoices') },
  { icon:'ğŸ’±', ar:'Ø§Ù„Ø¹Ù…Ù„Ø§Øª',         en:'Currencies',     fn:()=>openPage('currencies') },
];

// â”€â”€ RECENT TRANSACTIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const TX_DATA = [
  { no:'INV-2024-001', party:{ar:'Ø´Ø±ÙƒØ© Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©',en:'Elite Trading Co.'}, type:{ar:'ÙØ§ØªÙˆØ±Ø© Ù…Ø¨ÙŠØ¹Ø§Øª',en:'Sales Invoice'}, amount:'SAR 85,500', date:'2026-02-16', status:'paid' },
  { no:'PUR-2024-015', party:{ar:'Ù…Ø¤Ø³Ø³Ø© Ø§Ù„ØªÙˆØ±ÙŠØ¯ Ø§Ù„ÙˆØ·Ù†ÙŠ',en:'National Supply Est.'}, type:{ar:'ÙØ§ØªÙˆØ±Ø© Ù…Ø´ØªØ±ÙŠØ§Øª',en:'Purchase Invoice'}, amount:'SAR 42,000', date:'2026-02-15', status:'pending' },
  { no:'JE-2024-002',  party:{ar:'Ù‚ÙŠØ¯ Ù…ØµØ§Ø±ÙŠÙ',en:'Expense Entry'}, type:{ar:'Ù‚ÙŠØ¯ ÙŠÙˆÙ…ÙŠØ©',en:'Journal Entry'}, amount:'SAR 15,200', date:'2026-02-14', status:'approved' },
  { no:'REC-2024-010', party:{ar:'Ù…Ø¤Ø³Ø³Ø© Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø­Ø¯ÙŠØ«Ø©',en:'Modern Tech Est.'}, type:{ar:'Ø³Ù†Ø¯ Ù‚Ø¨Ø¶',en:'Receipt'}, amount:'SAR 30,000', date:'2026-02-13', status:'paid' },
  { no:'INV-2024-000', party:{ar:'Ø´Ø±ÙƒØ© Ø§Ù„Ø®Ù„ÙŠØ¬ Ù„Ù„ØªØ¬Ø§Ø±Ø©',en:'Gulf Commerce Co.'}, type:{ar:'ÙØ§ØªÙˆØ±Ø© Ù…Ø¨ÙŠØ¹Ø§Øª',en:'Sales Invoice'}, amount:'SAR 67,800', date:'2026-02-12', status:'overdue' },
];

const STATUS_MAP = {
  paid:     { ar:'Ù…Ø¯ÙÙˆØ¹Ø©',      en:'Paid',        cls:'badge-green' },
  pending:  { ar:'Ù…Ø¹Ù„Ù‚Ø©',       en:'Pending',     cls:'badge-amber' },
  approved: { ar:'Ù…Ø¹ØªÙ…Ø¯Ø©',      en:'Approved',    cls:'badge-blue'  },
  overdue:  { ar:'Ù…ØªØ£Ø®Ø±Ø©',      en:'Overdue',     cls:'badge-red'   },
};

// â”€â”€ PAGE CONTENT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const PAGES = {
  salesInvoices:{
    ar:{title:'ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª',icon:'ğŸ§¾'},
    en:{title:'Sales Invoices',icon:'ğŸ§¾'},
    render: renderSalesInvoices
  },
  customers:{
    ar:{title:'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡',icon:'ğŸ‘¥'},
    en:{title:'Customer Management',icon:'ğŸ‘¥'},
    render: renderCustomers
  },
  chartOfAccounts:{
    ar:{title:'Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª',icon:'ğŸ“‹'},
    en:{title:'Chart of Accounts',icon:'ğŸ“‹'},
    render: renderChartOfAccounts
  },
  journalEntries:{
    ar:{title:'Ø§Ù„Ù‚ÙŠÙˆØ¯ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©',icon:'ğŸ“'},
    en:{title:'Journal Entries',icon:'ğŸ“'},
    render: renderJournalEntries
  },
  financialReports:{
    ar:{title:'Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©',icon:'ğŸ“ˆ'},
    en:{title:'Financial Reports',icon:'ğŸ“ˆ'},
    render: renderFinancialReports
  },
  trialBalance:{
    ar:{title:'Ù…ÙŠØ²Ø§Ù† Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©',icon:'âš–ï¸'},
    en:{title:'Trial Balance',icon:'âš–ï¸'},
    render: renderTrialBalance
  },
  products:{
    ar:{title:'Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ù…Ø®Ø²ÙˆÙ†',icon:'ğŸ“¦'},
    en:{title:'Products & Inventory',icon:'ğŸ“¦'},
    render: renderProducts
  },
  purchaseInvoices:{
    ar:{title:'ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª',icon:'ğŸ“¦'},
    en:{title:'Purchase Invoices',icon:'ğŸ“¦'},
    render: renderPurchaseInvoices
  },
  suppliers:{
    ar:{title:'Ø§Ù„Ù…ÙˆØ±Ø¯ÙˆÙ†',icon:'ğŸ­'},
    en:{title:'Suppliers',icon:'ğŸ­'},
    render: renderSuppliers
  },
  receipts:{
    ar:{title:'Ø³Ù†Ø¯Ø§Øª Ø§Ù„Ù‚Ø¨Ø¶',icon:'ğŸ’µ'},
    en:{title:'Receipts',icon:'ğŸ’µ'},
    render: renderReceipts
  },
  payments:{
    ar:{title:'Ø³Ù†Ø¯Ø§Øª Ø§Ù„ØµØ±Ù',icon:'ğŸ’³'},
    en:{title:'Payments',icon:'ğŸ’³'},
    render: renderPayments
  },
  stockMovement:{
    ar:{title:'Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ø®Ø²ÙˆÙ†',icon:'ğŸ”€'},
    en:{title:'Stock Movement',icon:'ğŸ”€'},
    render: renderStockMovement
  },
  company:{
    ar:{title:'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø±ÙƒØ©',icon:'ğŸ¢'},
    en:{title:'Company Info',icon:'ğŸ¢'},
    render: renderCompany
  },
  currencies:{
    ar:{title:'Ø§Ù„Ø¹Ù…Ù„Ø§Øª',icon:'ğŸ’±'},
    en:{title:'Currencies',icon:'ğŸ’±'},
    render: renderCurrencies
  },
  users:{
    ar:{title:'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†',icon:'ğŸ‘¤'},
    en:{title:'Users',icon:'ğŸ‘¤'},
    render: renderUsers
  },
  salesReturns:{
    ar:{title:'Ù…Ø±Ø¯ÙˆØ¯Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª',icon:'â†©ï¸'},
    en:{title:'Sales Returns',icon:'â†©ï¸'},
    render: renderSalesReturns
  },
  purchaseReturns:{
    ar:{title:'Ù…Ø±Ø¯ÙˆØ¯Ø§Øª Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª',icon:'ğŸ”„'},
    en:{title:'Purchase Returns',icon:'ğŸ”„'},
    render: renderPurchaseReturns
  },
  warehouseRpt:{
    ar:{title:'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø®Ø²Ù†',icon:'ğŸª'},
    en:{title:'Warehouse Report',icon:'ğŸª'},
    render: renderWarehouseReport
  },
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function init(){
  applyLang(S.lang);
  applyDark(S.dark);
  buildSidebar();
  renderKPIs();
  renderQA();
  renderTxTable();
  initCharts();
  bindEvents();
  if(!S.onboarded) startOnboarding();
}

// â”€â”€ LANG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function t(obj){ return obj[S.lang]||obj.ar||obj.en||''; }

function applyLang(lang){
  S.lang = lang;
  localStorage.setItem('vfa-lang',lang);
  const isAr = lang==='ar';
  document.documentElement.lang = lang;
  document.documentElement.dir  = isAr ? 'rtl':'ltr';
  document.body.style.fontFamily = isAr
    ? "'Tajawal',sans-serif"
    : "'Inter',sans-serif";
  document.getElementById('langLabel').textContent = isAr ? 'EN':'Ø¹';
  document.querySelectorAll('[data-ar][data-en]').forEach(el=>{
    el.textContent = isAr ? el.dataset.ar : el.dataset.en;
  });
  document.querySelectorAll('input[data-ar][data-en]').forEach(el=>{
    el.placeholder = isAr ? el.dataset.ar : el.dataset.en;
  });
}

function toggleLang(){
  applyLang(S.lang==='ar'?'en':'ar');
  // Re-render current modal if open
  if(document.getElementById('modalBackdrop').classList.contains('open')){
    const pid = document.getElementById('modalPanel').dataset.page;
    if(pid) openPage(pid);
  }
  buildSidebar();
  renderKPIs();
  renderQA();
  renderTxTable();
}

// â”€â”€ DARK MODE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function applyDark(dark){
  S.dark = dark;
  localStorage.setItem('vfa-dark', dark?'1':'0');
  document.body.classList.toggle('dark',dark);
  document.getElementById('themeBtn').textContent = dark ? 'â˜€ï¸':'ğŸŒ™';
  // Update charts
  Object.values(S.charts).forEach(c=>{ c.update?.(); });
}

// â”€â”€ SIDEBAR BUILD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function buildSidebar(){
  const el = document.getElementById('sidebarInner');
  el.innerHTML = MENU.map(g=>`
    <div class="nav-group">
      <div class="nav-group-title">${t(g.group)}</div>
      ${g.items.map(item=>`
        <button class="nav-link${item.id===S.activePage?' active':''}"
          onclick="openPage('${item.id}')" >
          <span class="nav-icon">${item.icon}</span>
          <span class="nav-text">${t(item)}</span>
          ${item.badge?`<span class="nav-badge">${item.badge}</span>`:''}
        </button>
      `).join('')}
    </div>
  `).join('');
}

// â”€â”€ KPIs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderKPIs(){
  document.getElementById('kpis').innerHTML = KPI_DATA.map(k=>`
    <div class="kpi">
      <div class="kpi-top">
        <div class="kpi-icon">${k.icon}</div>
        <div class="kpi-badge ${k.type}">${k.badge}</div>
      </div>
      <div class="kpi-val">${k.val}</div>
      <div class="kpi-label">${S.lang==='ar'?k.ar:k.en}</div>
    </div>
  `).join('');
}

// â”€â”€ QUICK ACTIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderQA(){
  document.getElementById('qaGrid').innerHTML = QA_DATA.map(q=>`
    <div class="qa-item" onclick="(${q.fn.toString()})()">
      <div class="qa-icon">${q.icon}</div>
      <div class="qa-label">${S.lang==='ar'?q.ar:q.en}</div>
    </div>
  `).join('');
}

// â”€â”€ TX TABLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderTxTable(){
  const s = STATUS_MAP;
  document.getElementById('txTable').innerHTML = TX_DATA.map(tx=>`
    <tr>
      <td><strong>${tx.no}</strong></td>
      <td>${t(tx.party)}</td>
      <td>${t(tx.type)}</td>
      <td><strong>${tx.amount}</strong></td>
      <td>${tx.date}</td>
      <td><span class="badge ${s[tx.status].cls}">${S.lang==='ar'?s[tx.status].ar:s[tx.status].en}</span></td>
      <td>
        <button class="btn-icon" data-tip="${S.lang==='ar'?'Ø¹Ø±Ø¶':'View'}" onclick="showToast('info','${tx.no}','ğŸ‘ï¸')">ğŸ‘ï¸</button>
        <button class="btn-icon" data-tip="${S.lang==='ar'?'Ø·Ø¨Ø§Ø¹Ø©':'Print'}" onclick="window.print()">ğŸ–¨ï¸</button>
      </td>
    </tr>
  `).join('');
}

// â”€â”€ CHARTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function chartDefaults(){
  return {
    plugins:{ legend:{ labels:{ color: S.dark?'#CBD5E1':'#4A5568', font:{family:S.lang==='ar'?'Tajawal':'Inter',size:11} }}},
    scales:{ x:{ ticks:{ color:S.dark?'#64748B':'#94A3B8' }, grid:{ color:S.dark?'rgba(255,255,255,.05)':'rgba(0,0,0,.05)' }},
             y:{ ticks:{ color:S.dark?'#64748B':'#94A3B8' }, grid:{ color:S.dark?'rgba(255,255,255,.05)':'rgba(0,0,0,.05)' }}},
    responsive:true, maintainAspectRatio:false,
    animation:{ duration:800, easing:'easeInOutQuart' }
  };
}

function initCharts(){
  const months_ar=['ÙŠÙ†Ø§ÙŠØ±','ÙØ¨Ø±Ø§ÙŠØ±','Ù…Ø§Ø±Ø³','Ø£Ø¨Ø±ÙŠÙ„','Ù…Ø§ÙŠÙˆ','ÙŠÙˆÙ†ÙŠÙˆ'];
  const months_en=['Jan','Feb','Mar','Apr','May','Jun'];
  const months = S.lang==='ar' ? months_ar : months_en;

  // Revenue chart
  const rc = document.getElementById('revenueChart');
  if(rc){
    if(S.charts.rev) S.charts.rev.destroy();
    S.charts.rev = new Chart(rc,{
      type:'line',
      data:{
        labels:months,
        datasets:[{
          label: S.lang==='ar'?'Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª':'Revenue',
          data:[210000,185000,245000,198000,270000,312450],
          borderColor:'#00897B',backgroundColor:'rgba(0,137,123,.1)',
          fill:true,tension:.4,pointBackgroundColor:'#00897B',pointRadius:4
        },{
          label: S.lang==='ar'?'Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª':'Expenses',
          data:[165000,140000,190000,155000,210000,245000],
          borderColor:'#D4AF37',backgroundColor:'rgba(212,175,55,.1)',
          fill:true,tension:.4,pointBackgroundColor:'#D4AF37',pointRadius:4
        }]
      },
      options:{...chartDefaults()}
    });
  }

  // Sales distribution chart
  const sc = document.getElementById('salesChart');
  if(sc){
    if(S.charts.sal) S.charts.sal.destroy();
    S.charts.sal = new Chart(sc,{
      type:'doughnut',
      data:{
        labels: S.lang==='ar'
          ?['Ù…Ù†ØªØ¬Ø§Øª','Ø®Ø¯Ù…Ø§Øª','Ø§Ø³ØªØ´Ø§Ø±Ø§Øª','ØªØ¯Ø±ÙŠØ¨']
          :['Products','Services','Consulting','Training'],
        datasets:[{
          data:[45,25,20,10],
          backgroundColor:['#00695C','#00897B','#D4AF37','#F0D060'],
          borderWidth:0,hoverOffset:8
        }]
      },
      options:{
        ...chartDefaults(),
        scales:{},
        cutout:'65%',
        plugins:{legend:{position:'bottom',labels:{padding:16}}}
      }
    });
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MODAL & PAGE NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openPage(id){
  if(!PAGES[id]) return;
  S.activePage = id;
  buildSidebar();
  const pg = PAGES[id];
  const meta = pg[S.lang]||pg.ar;
  openModal(meta.icon+' '+meta.title, pg.render, id);
}

function showPage(id){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  const el = document.getElementById('page-'+id);
  if(el) el.classList.add('active');
  S.activePage = id;
  buildSidebar();
  closeSidebar();
}

function openModal(title, renderFn, pageId){
  const bd = document.getElementById('modalBackdrop');
  const panel = document.getElementById('modalPanel');
  document.getElementById('modalTitle').textContent = title;
  document.getElementById('modalToolbar').innerHTML = '';
  document.getElementById('modalBody').innerHTML = '';
  document.getElementById('modalFooter').innerHTML = '';
  panel.dataset.page = pageId||'';
  bd.classList.add('open');
  closeSidebar();
  if(typeof renderFn==='function') renderFn();
}

function closeModal(){
  document.getElementById('modalBackdrop').classList.remove('open');
  S.activePage = 'dashboard';
  buildSidebar();
}

// â”€â”€ PAGE RENDERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderSalesInvoices(){
  const tb = document.getElementById('modalToolbar');
  tb.innerHTML = `
    <button class="btn btn-primary" onclick="renderNewInvoiceForm()">
      <span>â•</span> <span>${S.lang==='ar'?'ÙØ§ØªÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©':'New Invoice'}</span>
    </button>
    <select class="btn btn-ghost" style="cursor:pointer;" onchange="showToast('info',this.value,'ğŸ”')">
      <option>${S.lang==='ar'?'ÙƒÙ„ Ø§Ù„ÙÙˆØ§ØªÙŠØ±':'All Invoices'}</option>
      <option>${S.lang==='ar'?'Ù…Ø¯ÙÙˆØ¹Ø©':'Paid'}</option>
      <option>${S.lang==='ar'?'Ù…Ø¹Ù„Ù‚Ø©':'Pending'}</option>
      <option>${S.lang==='ar'?'Ù…ØªØ£Ø®Ø±Ø©':'Overdue'}</option>
    </select>
    <button class="btn btn-ghost" onclick="window.print()">ğŸ–¨ï¸ ${S.lang==='ar'?'Ø·Ø¨Ø§Ø¹Ø©':'Print'}</button>
    <button class="btn btn-ghost">ğŸ“¤ ${S.lang==='ar'?'ØªØµØ¯ÙŠØ±':'Export'}</button>
  `;

  const invData = [
    { no:'INV-2024-001', customer:{ar:'Ø´Ø±ÙƒØ© Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©',en:'Elite Trading Co.'}, amount:'SAR 85,500', date:'2026-02-16', due:'2026-03-16', status:'paid' },
    { no:'INV-2024-002', customer:{ar:'Ù…Ø¤Ø³Ø³Ø© Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø­Ø¯ÙŠØ«Ø©',en:'Modern Tech Est.'}, amount:'SAR 42,000', date:'2026-02-15', due:'2026-03-15', status:'pending' },
    { no:'INV-2024-003', customer:{ar:'Ø´Ø±ÙƒØ© Ø§Ù„Ø®Ù„ÙŠØ¬ Ù„Ù„ØªØ¬Ø§Ø±Ø©',en:'Gulf Commerce Co.'}, amount:'SAR 67,800', date:'2026-02-10', due:'2026-02-24', status:'overdue' },
    { no:'INV-2024-004', customer:{ar:'Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø¯ÙˆÙ„ÙŠØ©',en:'Intl Business Est.'}, amount:'SAR 28,400', date:'2026-02-08', due:'2026-03-08', status:'paid' },
    { no:'INV-2024-005', customer:{ar:'Ø´Ø±ÙƒØ© Ø§Ù„ØªØ·ÙˆÙŠØ± ÙˆØ§Ù„Ø§Ø³ØªØ´Ø§Ø±Ø§Øª',en:'Dev & Consult Co.'}, amount:'SAR 55,000', date:'2026-02-05', due:'2026-03-05', status:'pending' },
  ];

  document.getElementById('modalBody').innerHTML = `
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-bottom:1.5rem;">
      <div class="kpi">
        <div class="kpi-top"><div class="kpi-icon">ğŸ§¾</div><div class="kpi-badge up">+5</div></div>
        <div class="kpi-val">23</div><div class="kpi-label">${S.lang==='ar'?'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙÙˆØ§ØªÙŠØ±':'Total Invoices'}</div>
      </div>
      <div class="kpi">
        <div class="kpi-top"><div class="kpi-icon">âœ…</div><div class="kpi-badge up">78%</div></div>
        <div class="kpi-val">SAR 218,700</div><div class="kpi-label">${S.lang==='ar'?'Ù…Ø¯ÙÙˆØ¹Ø©':'Paid'}</div>
      </div>
      <div class="kpi">
        <div class="kpi-top"><div class="kpi-icon">â³</div><div class="kpi-badge warn">3</div></div>
        <div class="kpi-val">SAR 97,000</div><div class="kpi-label">${S.lang==='ar'?'Ù…Ø¹Ù„Ù‚Ø©':'Pending'}</div>
      </div>
      <div class="kpi">
        <div class="kpi-top"><div class="kpi-icon">ğŸš¨</div><div class="kpi-badge down">1</div></div>
        <div class="kpi-val">SAR 67,800</div><div class="kpi-label">${S.lang==='ar'?'Ù…ØªØ£Ø®Ø±Ø©':'Overdue'}</div>
      </div>
    </div>
    <div class="table-card">
      <div class="table-wrap">
        <table>
          <thead><tr>
            <th>${S.lang==='ar'?'Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©':'Invoice #'}</th>
            <th>${S.lang==='ar'?'Ø§Ù„Ø¹Ù…ÙŠÙ„':'Customer'}</th>
            <th>${S.lang==='ar'?'Ø§Ù„Ù…Ø¨Ù„Øº':'Amount'}</th>
            <th>${S.lang==='ar'?'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø±':'Issue Date'}</th>
            <th>${S.lang==='ar'?'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚':'Due Date'}</th>
            <th>${S.lang==='ar'?'Ø§Ù„Ø­Ø§Ù„Ø©':'Status'}</th>
            <th>${S.lang==='ar'?'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª':'Actions'}</th>
          </tr></thead>
          <tbody>
            ${invData.map(i=>`
              <tr>
                <td><strong style="color:var(--primary)">${i.no}</strong></td>
                <td>${t(i.customer)}</td>
                <td><strong>${i.amount}</strong></td>
                <td>${i.date}</td>
                <td style="color:${i.status==='overdue'?'var(--red)':'inherit'}">${i.due}</td>
                <td><span class="badge ${STATUS_MAP[i.status].cls}">${S.lang==='ar'?STATUS_MAP[i.status].ar:STATUS_MAP[i.status].en}</span></td>
                <td>
                  <button class="btn-icon" onclick="showToast('info','${i.no}','ğŸ‘ï¸')">ğŸ‘ï¸</button>
                  <button class="btn-icon" onclick="showToast('info','${S.lang==='ar'?'Ø¬Ø§Ø±ÙŠ ØªØ­Ø±ÙŠØ±':'Editing'} ${i.no}','âœï¸')">âœï¸</button>
                  <button class="btn-icon" onclick="window.print()">ğŸ–¨ï¸</button>
                </td>
              </tr>`).join('')}
          </tbody>
        </table>
      </div>
    </div>
  `;

  document.getElementById('modalFooter').innerHTML = `
    <button class="btn btn-ghost" onclick="closeModal()">${S.lang==='ar'?'Ø¥ØºÙ„Ø§Ù‚':'Close'}</button>
    <button class="btn btn-primary" onclick="renderNewInvoiceForm()">â• ${S.lang==='ar'?'Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø©':'Create Invoice'}</button>
  `;
}

function renderNewInvoiceForm(){
  document.getElementById('modalTitle').textContent = (S.lang==='ar'?'ğŸ§¾ ÙØ§ØªÙˆØ±Ø© Ù…Ø¨ÙŠØ¹Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©':'ğŸ§¾ New Sales Invoice');
  document.getElementById('modalToolbar').innerHTML = `
    <span style="font-size:.82rem;color:var(--text3)">${S.lang==='ar'?'Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©: INV-2024-006':'Invoice No: INV-2024-006'}</span>
  `;
  document.getElementById('modalBody').innerHTML = `
    <div class="form-grid" style="margin-bottom:1.25rem;">
      <div class="field">
        <label>${S.lang==='ar'?'Ø§Ù„Ø¹Ù…ÙŠÙ„':'Customer'}</label>
        <select><option>${S.lang==='ar'?'Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù…ÙŠÙ„...':'Select Customer...'}</option>
          <option>${S.lang==='ar'?'Ø´Ø±ÙƒØ© Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©':'Elite Trading Co.'}</option>
          <option>${S.lang==='ar'?'Ù…Ø¤Ø³Ø³Ø© Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø­Ø¯ÙŠØ«Ø©':'Modern Tech Est.'}</option>
        </select>
      </div>
      <div class="field">
        <label>${S.lang==='ar'?'ØªØ§Ø±ÙŠØ® Ø§Ù„ÙØ§ØªÙˆØ±Ø©':'Invoice Date'}</label>
        <input type="date" value="2026-02-17">
      </div>
      <div class="field">
        <label>${S.lang==='ar'?'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚':'Due Date'}</label>
        <input type="date" value="2026-03-17">
      </div>
      <div class="field">
        <label>${S.lang==='ar'?'Ø§Ù„Ø¹Ù…Ù„Ø©':'Currency'}</label>
        <select><option>SAR - Ø±ÙŠØ§Ù„ Ø³Ø¹ÙˆØ¯ÙŠ</option><option>USD - Ø¯ÙˆÙ„Ø§Ø±</option><option>EUR - ÙŠÙˆØ±Ùˆ</option></select>
      </div>
    </div>
    <div class="inv-lines">
      <div class="inv-lines-head">
        <span>${S.lang==='ar'?'Ø§Ù„Ù…Ù†ØªØ¬/Ø§Ù„Ø®Ø¯Ù…Ø©':'Item/Service'}</span>
        <span>${S.lang==='ar'?'Ø§Ù„ÙƒÙ…ÙŠØ©':'Qty'}</span>
        <span>${S.lang==='ar'?'Ø§Ù„Ø³Ø¹Ø±':'Price'}</span>
        <span>${S.lang==='ar'?'Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ':'Total'}</span>
        <span></span>
      </div>
      <div class="inv-line">
        <input placeholder="${S.lang==='ar'?'Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ Ø£Ùˆ Ø§Ù„Ø®Ø¯Ù…Ø©...':'Product or service name...'}">
        <input type="number" value="1" min="1" oninput="calcInvLine(this)">
        <div class="input-group"><span class="input-prefix">${S.lang==='ar'?'Ø±.Ø³':'SAR'}</span><input type="number" value="0" oninput="calcInvLine(this)"></div>
        <input readonly value="0.00" style="color:var(--primary);font-weight:700;">
        <button class="btn-icon" onclick="this.closest('.inv-line').remove();calcTotals()">ğŸ—‘ï¸</button>
      </div>
    </div>
    <button class="btn btn-ghost btn-sm" onclick="addInvLine()">â• ${S.lang==='ar'?'Ø¥Ø¶Ø§ÙØ© Ø³Ø·Ø±':'Add Line'}</button>
    <div class="inv-totals" id="invTotals">
      <div class="inv-total-row"><span>${S.lang==='ar'?'Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ:':'Subtotal:'}</span><span>SAR 0.00</span></div>
      <div class="inv-total-row"><span>${S.lang==='ar'?'Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ© (15%):':'VAT (15%):'}</span><span>SAR 0.00</span></div>
      <div class="inv-total-row grand"><span>${S.lang==='ar'?'Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:':'Grand Total:'}</span><span>SAR 0.00</span></div>
    </div>
    <div class="field form-full" style="margin-top:1rem;">
      <label>${S.lang==='ar'?'Ù…Ù„Ø§Ø­Ø¸Ø§Øª':'Notes'}</label>
      <textarea placeholder="${S.lang==='ar'?'Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©...':'Any additional notes...'}"></textarea>
    </div>
  `;
  document.getElementById('modalFooter').innerHTML = `
    <button class="btn btn-ghost" onclick="openPage('salesInvoices')">${S.lang==='ar'?'Ø±Ø¬ÙˆØ¹':'Back'}</button>
    <button class="btn btn-outline" onclick="showToast('info','${S.lang==='ar'?'ØªÙ… Ø§Ù„Ø­ÙØ¸ ÙƒÙ…Ø³ÙˆØ¯Ø©':'Saved as draft'}','ğŸ“')">${S.lang==='ar'?'Ø­ÙØ¸ ÙƒÙ…Ø³ÙˆØ¯Ø©':'Save Draft'}</button>
    <button class="btn btn-primary" onclick="showToast('success','${S.lang==='ar'?'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­':'Invoice created successfully'}','âœ“');closeModal()">ğŸ’¾ ${S.lang==='ar'?'Ø¥ØµØ¯Ø§Ø± Ø§Ù„ÙØ§ØªÙˆØ±Ø©':'Issue Invoice'}</button>
  `;
}

function addInvLine(){
  const wrap = document.querySelector('.inv-lines');
  const line = document.createElement('div');
  line.className='inv-line';
  line.innerHTML=`
    <input placeholder="${S.lang==='ar'?'Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬...':'Product name...'}">
    <input type="number" value="1" min="1" oninput="calcInvLine(this)">
    <div class="input-group"><span class="input-prefix">${S.lang==='ar'?'Ø±.Ø³':'SAR'}</span><input type="number" value="0" oninput="calcInvLine(this)"></div>
    <input readonly value="0.00" style="color:var(--primary);font-weight:700;">
    <button class="btn-icon" onclick="this.closest('.inv-line').remove();calcTotals()">ğŸ—‘ï¸</button>
  `;
  wrap.appendChild(line);
}

function calcInvLine(input){
  const line = input.closest('.inv-line');
  const inputs = line.querySelectorAll('input[type=number]');
  const qty = parseFloat(inputs[0].value)||0;
  const price = parseFloat(inputs[1].value)||0;
  line.querySelectorAll('input[readonly]')[0].value = (qty*price).toFixed(2);
  calcTotals();
}

function calcTotals(){
  let sub=0;
  document.querySelectorAll('.inv-line').forEach(l=>{
    sub += parseFloat(l.querySelector('input[readonly]')?.value||0);
  });
  const vat = sub*0.15;
  const t = document.getElementById('invTotals');
  if(!t) return;
  const rows = t.querySelectorAll('.inv-total-row span:last-child');
  if(rows[0]) rows[0].textContent = `SAR ${sub.toFixed(2)}`;
  if(rows[1]) rows[1].textContent = `SAR ${vat.toFixed(2)}`;
  if(rows[2]) rows[2].textContent = `SAR ${(sub+vat).toFixed(2)}`;
}

function renderCustomers(){
  document.getElementById('modalToolbar').innerHTML=`
    <button class="btn btn-primary">â• ${S.lang==='ar'?'Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯':'New Customer'}</button>
    <button class="btn btn-ghost">ğŸ“¤ ${S.lang==='ar'?'ØªØµØ¯ÙŠØ±':'Export'}</button>
    <input placeholder="${S.lang==='ar'?'Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù…ÙŠÙ„...':'Search customer...'}" style="width:220px;height:36px;">
  `;
  const cust=[
    {name:{ar:'Ø´Ø±ÙƒØ© Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©',en:'Elite Trading Co.'},code:'C-001',balance:'SAR 85,500',status:'active',city:{ar:'Ø§Ù„Ø±ÙŠØ§Ø¶',en:'Riyadh'}},
    {name:{ar:'Ù…Ø¤Ø³Ø³Ø© Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø­Ø¯ÙŠØ«Ø©',en:'Modern Tech Est.'},code:'C-002',balance:'SAR 42,000',status:'pending',city:{ar:'Ø¬Ø¯Ø©',en:'Jeddah'}},
    {name:{ar:'Ø´Ø±ÙƒØ© Ø§Ù„Ø®Ù„ÙŠØ¬ Ù„Ù„ØªØ¬Ø§Ø±Ø©',en:'Gulf Commerce Co.'},code:'C-003',balance:'SAR 67,800',status:'active',city:{ar:'Ø§Ù„Ø¯Ù…Ø§Ù…',en:'Dammam'}},
    {name:{ar:'Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø¯ÙˆÙ„ÙŠØ©',en:'Intl Business Est.'},code:'C-004',balance:'SAR 28,400',status:'active',city:{ar:'Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø©',en:'Makkah'}},
  ];
  document.getElementById('modalBody').innerHTML=`
    <div style="display:grid;gap:1rem;">
      ${cust.map(c=>`
        <div class="overview-card" style="background:var(--bg-card);border:1px solid var(--border);border-radius:var(--r16);padding:1.1rem;display:flex;align-items:center;gap:1rem;transition:all .3s;cursor:pointer;"
          onmouseenter="this.style.transform='translateY(-3px)';this.style.boxShadow='var(--shadow-lg)'"
          onmouseleave="this.style.transform='';this.style.boxShadow=''">
          <div class="avatar">${t(c.name).charAt(0)}</div>
          <div style="flex:1">
            <div style="font-weight:700;margin-bottom:.2rem">${t(c.name)}</div>
            <div style="font-size:.78rem;color:var(--text3)">${c.code} Â· ${t(c.city)}</div>
          </div>
          <div style="text-align:end">
            <div style="font-weight:700;color:var(--primary)">${c.balance}</div>
            <span class="badge ${c.status==='active'?'badge-green':'badge-amber'}">${c.status==='active'?(S.lang==='ar'?'Ù†Ø´Ø·':'Active'):(S.lang==='ar'?'Ù…Ø¹Ù„Ù‚':'Pending')}</span>
          </div>
          <div style="display:flex;gap:.4rem">
            <button class="btn-icon" onclick="showToast('info','${t(c.name)}','ğŸ‘ï¸')">ğŸ‘ï¸</button>
            <button class="btn-icon">âœï¸</button>
          </div>
        </div>
      `).join('')}
    </div>
  `;
}

function renderChartOfAccounts(){
  document.getElementById('modalToolbar').innerHTML=`
    <button class="btn btn-primary">â• ${S.lang==='ar'?'Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯':'New Account'}</button>
    <button class="btn btn-ghost">ğŸ“¤ ${S.lang==='ar'?'ØªØµØ¯ÙŠØ±':'Export'}</button>
  `;
  const groups=[
    {type:{ar:'Ø§Ù„Ø£ØµÙˆÙ„',en:'Assets'},icon:'ğŸ’°',color:'badge-green',accounts:[
      {code:'1000',name:{ar:'Ø§Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ù…ØªØ¯Ø§ÙˆÙ„Ø©',en:'Current Assets'},bal:'SAR 450,000'},
      {code:'1100',name:{ar:'Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© ÙˆØ§Ù„Ø¨Ù†ÙˆÙƒ',en:'Cash & Banks'},bal:'SAR 185,000',indent:true},
      {code:'1200',name:{ar:'Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù‚Ø¨Ø¶',en:'Accounts Receivable'},bal:'SAR 245,000',indent:true},
      {code:'1300',name:{ar:'Ø§Ù„Ù…Ø®Ø²ÙˆÙ†',en:'Inventory'},bal:'SAR 20,000',indent:true},
    ]},
    {type:{ar:'Ø§Ù„Ø®ØµÙˆÙ…',en:'Liabilities'},icon:'ğŸ“‹',color:'badge-red',accounts:[
      {code:'2000',name:{ar:'Ø§Ù„Ø®ØµÙˆÙ… Ø§Ù„Ù…ØªØ¯Ø§ÙˆÙ„Ø©',en:'Current Liabilities'},bal:'SAR 125,000'},
      {code:'2100',name:{ar:'Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¯ÙØ¹',en:'Accounts Payable'},bal:'SAR 85,000',indent:true},
      {code:'2200',name:{ar:'Ù…Ø³ØªØ­Ù‚Ø§Øª Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨',en:'Tax Payable'},bal:'SAR 40,000',indent:true},
    ]},
    {type:{ar:'Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©',en:'Equity'},icon:'âš–ï¸',color:'badge-blue',accounts:[
      {code:'3000',name:{ar:'Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„',en:'Capital'},bal:'SAR 325,000'},
      {code:'3100',name:{ar:'Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ù…Ø­ØªØ¬Ø²Ø©',en:'Retained Earnings'},bal:'SAR 200,000',indent:true},
    ]},
  ];
  document.getElementById('modalBody').innerHTML=groups.map(g=>`
    <div class="report-card" style="margin-bottom:1rem;">
      <div class="report-card-head">
        <span style="display:flex;align-items:center;gap:.5rem;font-weight:700;">${g.icon} ${t(g.type)}</span>
        <span class="badge ${g.color}">${g.accounts.length} ${S.lang==='ar'?'Ø­Ø³Ø§Ø¨Ø§Øª':'Accounts'}</span>
      </div>
      <table style="width:100%;border-collapse:collapse;">
        <thead><tr>
          <th>${S.lang==='ar'?'ÙƒÙˆØ¯':'Code'}</th>
          <th>${S.lang==='ar'?'Ø§Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨':'Account Name'}</th>
          <th style="text-align:end">${S.lang==='ar'?'Ø§Ù„Ø±ØµÙŠØ¯':'Balance'}</th>
          <th style="text-align:end">${S.lang==='ar'?'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª':'Actions'}</th>
        </tr></thead>
        <tbody>
          ${g.accounts.map(a=>`
            <tr>
              <td><code style="font-size:.8rem;color:var(--primary)">${a.code}</code></td>
              <td style="padding-inline-start:${a.indent?'2rem':'1rem'};font-weight:${a.indent?400:700}">${t(a.name)}</td>
              <td style="text-align:end;font-weight:600">${a.bal}</td>
              <td style="text-align:end">
                <button class="btn-icon btn-sm">ğŸ‘ï¸</button>
                <button class="btn-icon btn-sm">âœï¸</button>
              </td>
            </tr>
          `).join('')}
        </tbody>
      </table>
    </div>
  `).join('');
}

function renderJournalEntries(){
  document.getElementById('modalToolbar').innerHTML=`
    <button class="btn btn-primary">â• ${S.lang==='ar'?'Ù‚ÙŠØ¯ Ø¬Ø¯ÙŠØ¯':'New Entry'}</button>
    <button class="btn btn-ghost">ğŸ“¤ ${S.lang==='ar'?'ØªØµØ¯ÙŠØ±':'Export'}</button>
  `;
  const je=[
    {no:'JE-2024-001',date:'2026-02-16',desc:{ar:'Ù‚ÙŠØ¯ Ø§ÙØªØªØ§Ø­ÙŠ',en:'Opening Entry'},dr:'SAR 250,000',cr:'SAR 250,000',status:'approved'},
    {no:'JE-2024-002',date:'2026-02-15',desc:{ar:'Ù…ØµØ§Ø±ÙŠÙ Ø¥Ø¯Ø§Ø±ÙŠØ©',en:'Admin Expenses'},dr:'SAR 45,000',cr:'SAR 45,000',status:'pending'},
    {no:'JE-2024-003',date:'2026-02-14',desc:{ar:'Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ù…Ø¨ÙŠØ¹Ø§Øª',en:'Sales Revenue'},dr:'SAR 85,500',cr:'SAR 85,500',status:'approved'},
  ];
  document.getElementById('modalBody').innerHTML=`
    <div class="table-card">
      <div class="table-wrap">
        <table>
          <thead><tr>
            <th>${S.lang==='ar'?'Ø±Ù‚Ù… Ø§Ù„Ù‚ÙŠØ¯':'Entry No.'}</th>
            <th>${S.lang==='ar'?'Ø§Ù„ØªØ§Ø±ÙŠØ®':'Date'}</th>
            <th>${S.lang==='ar'?'Ø§Ù„ÙˆØµÙ':'Description'}</th>
            <th style="text-align:end">${S.lang==='ar'?'Ù…Ø¯ÙŠÙ†':'Debit'}</th>
            <th style="text-align:end">${S.lang==='ar'?'Ø¯Ø§Ø¦Ù†':'Credit'}</th>
            <th>${S.lang==='ar'?'Ø§Ù„Ø­Ø§Ù„Ø©':'Status'}</th>
            <th>${S.lang==='ar'?'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª':'Actions'}</th>
          </tr></thead>
          <tbody>
            ${je.map(j=>`<tr>
              <td><strong style="color:var(--primary)">${j.no}</strong></td>
              <td>${j.date}</td><td>${t(j.desc)}</td>
              <td style="text-align:end;color:var(--emerald);font-weight:600">${j.dr}</td>
              <td style="text-align:end;color:var(--red);font-weight:600">${j.cr}</td>
              <td><span class="badge ${j.status==='approved'?'badge-green':'badge-amber'}">${S.lang==='ar'?(j.status==='approved'?'Ù…Ø¹ØªÙ…Ø¯Ø©':'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©'):(j.status==='approved'?'Approved':'Reviewing')}</span></td>
              <td><button class="btn-icon">ğŸ‘ï¸</button><button class="btn-icon">âœï¸</button></td>
            </tr>`).join('')}
          </tbody>
        </table>
      </div>
    </div>
  `;
}

function renderTrialBalance(){
  document.getElementById('modalToolbar').innerHTML=`
    <input type="month" value="2026-02" style="height:36px;width:180px;">
    <button class="btn btn-ghost">ğŸ–¨ï¸ ${S.lang==='ar'?'Ø·Ø¨Ø§Ø¹Ø©':'Print'}</button>
    <button class="btn btn-ghost">ğŸ“¤ ${S.lang==='ar'?'ØªØµØ¯ÙŠØ±':'Export'}</button>
  `;
  const accounts=[
    {code:'1100',name:{ar:'Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© ÙˆØ§Ù„Ø¨Ù†ÙˆÙƒ',en:'Cash & Banks'},dr:'185,000',cr:''},
    {code:'1200',name:{ar:'Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù‚Ø¨Ø¶',en:'Accounts Receivable'},dr:'245,000',cr:''},
    {code:'1300',name:{ar:'Ø§Ù„Ù…Ø®Ø²ÙˆÙ†',en:'Inventory'},dr:'20,000',cr:''},
    {code:'2100',name:{ar:'Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¯ÙØ¹',en:'Accounts Payable'},dr:'',cr:'85,000'},
    {code:'2200',name:{ar:'Ù…Ø³ØªØ­Ù‚Ø§Øª Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨',en:'Tax Payable'},dr:'',cr:'40,000'},
    {code:'3000',name:{ar:'Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„',en:'Capital'},dr:'',cr:'325,000'},
    {code:'4000',name:{ar:'Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª',en:'Sales Revenue'},dr:'',cr:'312,450'},
    {code:'5000',name:{ar:'ØªÙƒÙ„ÙØ© Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª',en:'Cost of Goods'},dr:'245,000',cr:''},
    {code:'5100',name:{ar:'Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©',en:'Admin Expenses'},dr:'67,450',cr:''},
  ];
  document.getElementById('modalBody').innerHTML=`
    <div class="report-card">
      <div class="report-card-head">
        <strong>${S.lang==='ar'?'Ù…ÙŠØ²Ø§Ù† Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© â€” ÙØ¨Ø±Ø§ÙŠØ± 2026':'Trial Balance â€” February 2026'}</strong>
        <span class="badge badge-green">âœ“ ${S.lang==='ar'?'Ù…ØªÙˆØ§Ø²Ù†':'Balanced'}</span>
      </div>
      <table style="width:100%;border-collapse:collapse;">
        <thead><tr>
          <th>${S.lang==='ar'?'ÙƒÙˆØ¯':'Code'}</th>
          <th>${S.lang==='ar'?'Ø§Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨':'Account'}</th>
          <th style="text-align:end">${S.lang==='ar'?'Ù…Ø¯ÙŠÙ†':'Debit'}</th>
          <th style="text-align:end">${S.lang==='ar'?'Ø¯Ø§Ø¦Ù†':'Credit'}</th>
        </tr></thead>
        <tbody>
          ${accounts.map(a=>`<tr>
            <td><code style="color:var(--primary);font-size:.8rem">${a.code}</code></td>
            <td>${t(a.name)}</td>
            <td style="text-align:end;color:var(--emerald);font-weight:600">${a.dr?'SAR '+a.dr:'â€”'}</td>
            <td style="text-align:end;color:var(--red);font-weight:600">${a.cr?'SAR '+a.cr:'â€”'}</td>
          </tr>`).join('')}
          <tr style="background:var(--grad-main);color:#fff;font-weight:800;font-size:.95rem;">
            <td colspan="2" style="padding:.875rem 1rem">${S.lang==='ar'?'Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ':'Total'}</td>
            <td style="text-align:end;padding:.875rem 1rem">SAR 762,450</td>
            <td style="text-align:end;padding:.875rem 1rem">SAR 762,450</td>
          </tr>
        </tbody>
      </table>
    </div>
  `;
}

function renderFinancialReports(){
  document.getElementById('modalToolbar').innerHTML=`
    <button class="btn btn-primary" onclick="showToast('info','${S.lang==='ar'?'Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ‚Ø±ÙŠØ±...':'Refreshing report...'}','ğŸ”„')">ğŸ”„ ${S.lang==='ar'?'ØªØ­Ø¯ÙŠØ«':'Refresh'}</button>
    <select class="btn btn-ghost" style="cursor:pointer">
      <option>Q1 2026</option><option>Q4 2025</option><option>Q3 2025</option>
    </select>
    <button class="btn btn-ghost">ğŸ–¨ï¸ ${S.lang==='ar'?'Ø·Ø¨Ø§Ø¹Ø©':'Print'}</button>
    <button class="btn btn-ghost">ğŸ“Š ${S.lang==='ar'?'ØªØµØ¯ÙŠØ± Excel':'Export Excel'}</button>
  `;
  document.getElementById('modalBody').innerHTML=`
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:1.25rem;margin-bottom:1.25rem;">
      <!-- P&L -->
      <div class="report-card">
        <div class="report-card-head"><strong>${S.lang==='ar'?'Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø®Ù„ (P&L)':'Income Statement (P&L)'}</strong></div>
        <div class="report-row subtotal"><span>${S.lang==='ar'?'Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª':'Sales Revenue'}</span><span style="color:var(--emerald)">SAR 312,450</span></div>
        <div class="report-row indent"><span>${S.lang==='ar'?'Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª':'Product Sales'}</span><span>SAR 250,000</span></div>
        <div class="report-row indent"><span>${S.lang==='ar'?'Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø®Ø¯Ù…Ø§Øª':'Service Revenue'}</span><span>SAR 62,450</span></div>
        <div class="divider"></div>
        <div class="report-row subtotal"><span>${S.lang==='ar'?'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±Ø¨Ø­':'Gross Profit'}</span><span>SAR 67,450</span></div>
        <div class="report-row indent"><span>${S.lang==='ar'?'ØªÙƒÙ„ÙØ© Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø© Ø§Ù„Ù…Ø¨Ø§Ø¹Ø©':'COGS'}</span><span style="color:var(--red)">SAR 245,000</span></div>
        <div class="divider"></div>
        <div class="report-row total"><span>${S.lang==='ar'?'ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­':'Net Profit'}</span><span>SAR 67,450</span></div>
      </div>
      <!-- Balance Sheet -->
      <div class="report-card">
        <div class="report-card-head"><strong>${S.lang==='ar'?'Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø¹Ù…ÙˆÙ…ÙŠØ©':'Balance Sheet'}</strong></div>
        <div class="report-row subtotal"><span>${S.lang==='ar'?'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ØµÙˆÙ„':'Total Assets'}</span><span style="color:var(--emerald)">SAR 450,000</span></div>
        <div class="report-row indent"><span>${S.lang==='ar'?'Ø§Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ù…ØªØ¯Ø§ÙˆÙ„Ø©':'Current Assets'}</span><span>SAR 430,000</span></div>
        <div class="report-row indent"><span>${S.lang==='ar'?'Ø§Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ø«Ø§Ø¨ØªØ©':'Fixed Assets'}</span><span>SAR 20,000</span></div>
        <div class="divider"></div>
        <div class="report-row subtotal"><span>${S.lang==='ar'?'Ø§Ù„Ø®ØµÙˆÙ… ÙˆØ­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©':'Liabilities & Equity'}</span><span>SAR 450,000</span></div>
        <div class="report-row indent"><span>${S.lang==='ar'?'Ø§Ù„Ø®ØµÙˆÙ…':'Liabilities'}</span><span style="color:var(--red)">SAR 125,000</span></div>
        <div class="report-row indent"><span>${S.lang==='ar'?'Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©':'Equity'}</span><span>SAR 325,000</span></div>
        <div class="report-row total"><span>${S.lang==='ar'?'Ù…ØªÙˆØ§Ø²Ù†':'Balanced'}</span><span>âœ“</span></div>
      </div>
    </div>
    <div class="chart-card">
      <div class="chart-head"><span class="chart-title">${S.lang==='ar'?'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø§Ù„ÙŠ':'Financial Performance Analysis'}</span></div>
      <div class="chart-wrap"><canvas id="perfChart"></canvas></div>
    </div>
  `;
  // Render performance chart
  setTimeout(()=>{
    const ctx=document.getElementById('perfChart');
    if(ctx){
      new Chart(ctx,{
        type:'bar',
        data:{
          labels:S.lang==='ar'?['ÙŠÙ†Ø§ÙŠØ±','ÙØ¨Ø±Ø§ÙŠØ±','Ù…Ø§Ø±Ø³','Ø£Ø¨Ø±ÙŠÙ„','Ù…Ø§ÙŠÙˆ','ÙŠÙˆÙ†ÙŠÙˆ']:['Jan','Feb','Mar','Apr','May','Jun'],
          datasets:[
            {label:S.lang==='ar'?'Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª':'Revenue',data:[210,185,245,198,270,312],backgroundColor:'rgba(0,137,123,.7)',borderRadius:6},
            {label:S.lang==='ar'?'Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª':'Expenses',data:[165,140,190,155,210,245],backgroundColor:'rgba(212,175,55,.7)',borderRadius:6},
            {label:S.lang==='ar'?'Ø§Ù„Ø£Ø±Ø¨Ø§Ø­':'Profit',data:[45,45,55,43,60,67],backgroundColor:'rgba(16,185,129,.7)',borderRadius:6},
          ]
        },
        options:{...chartDefaults(),plugins:{legend:{labels:{color:S.dark?'#CBD5E1':'#4A5568'}}}}
      });
    }
  },100);
}

function renderProducts(){
  document.getElementById('modalToolbar').innerHTML=`
    <button class="btn btn-primary">â• ${S.lang==='ar'?'Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯':'New Product'}</button>
    <button class="btn btn-ghost">ğŸ“Š ${S.lang==='ar'?'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø®Ø²ÙˆÙ†':'Inventory Report'}</button>
    <input placeholder="${S.lang==='ar'?'Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬...':'Search product...'}" style="height:36px;width:200px;">
  `;
  const products=[
    {name:{ar:'Ù„Ø§Ø¨ØªÙˆØ¨ HP ProBook',en:'HP ProBook Laptop'},sku:'HP-PB-450',stock:24,max:50,price:'SAR 3,200',icon:'ğŸ’»'},
    {name:{ar:'Ø·Ø§Ø¨Ø¹Ø© Canon LBP',en:'Canon LBP Printer'},sku:'CN-LBP-2900',stock:8,max:20,price:'SAR 850',icon:'ğŸ–¨ï¸'},
    {name:{ar:'Ø´Ø§Ø´Ø© Samsung 24"',en:'Samsung 24" Monitor'},sku:'SM-MNT-24',stock:3,max:15,price:'SAR 1,100',icon:'ğŸ–¥ï¸'},
    {name:{ar:'ÙƒÙŠØ¨ÙˆØ±Ø¯ Ù„Ø§Ø³Ù„ÙƒÙŠ',en:'Wireless Keyboard'},sku:'KB-WL-001',stock:45,max:60,price:'SAR 180',icon:'âŒ¨ï¸'},
    {name:{ar:'Ù…Ø§ÙˆØ³ Ù„Ø§Ø³Ù„ÙƒÙŠ',en:'Wireless Mouse'},sku:'MS-WL-002',stock:52,max:60,price:'SAR 120',icon:'ğŸ–±ï¸'},
    {name:{ar:'ÙÙ„Ø§Ø´ Ø¯ÙŠØ³Ùƒ 64GB',en:'64GB Flash Drive'},sku:'USB-64G',stock:2,max:30,price:'SAR 45',icon:'ğŸ’¾'},
  ];
  document.getElementById('modalBody').innerHTML=`
    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;">
      ${products.map(p=>{
        const pct=Math.round(p.stock/p.max*100);
        const color=pct>50?'var(--emerald)':pct>20?'var(--amber)':'var(--red)';
        return`<div class="inv-card">
          <div class="inv-card-icon">${p.icon}</div>
          <div class="inv-card-name">${t(p.name)}</div>
          <div class="inv-card-sku">${p.sku} Â· ${p.price}</div>
          <div class="inv-card-stock">
            <div class="stock-bar-wrap"><div class="stock-bar" style="width:${pct}%;background:${color}"></div></div>
            <span class="stock-num" style="color:${color}">${p.stock}/${p.max}</span>
          </div>
          ${p.stock<=5?`<div style="margin-top:.5rem"><span class="badge badge-red">âš ï¸ ${S.lang==='ar'?'Ù…Ø®Ø²ÙˆÙ† Ù…Ù†Ø®ÙØ¶':'Low Stock'}</span></div>`:''}
        </div>`;
      }).join('')}
    </div>
  `;
}

function renderCompany(){
  document.getElementById('modalBody').innerHTML=`
    <div class="form-grid">
      <div class="field"><label>${S.lang==='ar'?'Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©':'Company Name'}</label><input value="${S.lang==='ar'?'Ø´Ø±ÙƒØ© ÙÙŠ Ø¢ÙŠ Ø¨ÙŠ Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠØ©':'VIP Accounting Co.'}"></div>
      <div class="field"><label>${S.lang==='ar'?'Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„ØªØ¬Ø§Ø±ÙŠ':'Commercial Register'}</label><input value="1234567890"></div>
      <div class="field"><label>${S.lang==='ar'?'Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ':'Tax Number'}</label><input value="300123456789003"></div>
      <div class="field"><label>${S.lang==='ar'?'Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©':'Base Currency'}</label><select><option>SAR - Ø±ÙŠØ§Ù„ Ø³Ø¹ÙˆØ¯ÙŠ</option><option>USD</option><option>EUR</option></select></div>
      <div class="field form-full"><label>${S.lang==='ar'?'Ø§Ù„Ø¹Ù†ÙˆØ§Ù†':'Address'}</label><textarea>${S.lang==='ar'?'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©':'Riyadh, Saudi Arabia'}</textarea></div>
      <div class="field"><label>${S.lang==='ar'?'Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ©':'Fiscal Year'}</label><select><option>ÙŠÙ†Ø§ÙŠØ± - Ø¯ÙŠØ³Ù…Ø¨Ø±</option><option>Ø£Ø¨Ø±ÙŠÙ„ - Ù…Ø§Ø±Ø³</option></select></div>
      <div class="field"><label>${S.lang==='ar'?'Ù†Ø³Ø¨Ø© Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ©':'VAT Rate'}</label><div class="input-group has-suffix"><input type="number" value="15"><span class="input-suffix">%</span></div></div>
    </div>
  `;
  document.getElementById('modalFooter').innerHTML=`
    <button class="btn btn-ghost" onclick="closeModal()">${S.lang==='ar'?'Ø¥Ù„ØºØ§Ø¡':'Cancel'}</button>
    <button class="btn btn-primary" onclick="showToast('success','${S.lang==='ar'?'ØªÙ… Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø±ÙƒØ©':'Company info saved'}','âœ“');closeModal()">ğŸ’¾ ${S.lang==='ar'?'Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª':'Save Changes'}</button>
  `;
}

function renderCurrencies(){
  document.getElementById('modalToolbar').innerHTML=`<button class="btn btn-primary">â• ${S.lang==='ar'?'Ø¥Ø¶Ø§ÙØ© Ø¹Ù…Ù„Ø©':'Add Currency'}</button>`;
  const curr=[
    {code:'SAR',name:{ar:'Ø±ÙŠØ§Ù„ Ø³Ø¹ÙˆØ¯ÙŠ',en:'Saudi Riyal'},rate:'1.0000',default:true},
    {code:'USD',name:{ar:'Ø¯ÙˆÙ„Ø§Ø± Ø£Ù…Ø±ÙŠÙƒÙŠ',en:'US Dollar'},rate:'0.2667'},
    {code:'EUR',name:{ar:'ÙŠÙˆØ±Ùˆ',en:'Euro'},rate:'0.2450'},
    {code:'GBP',name:{ar:'Ø¬Ù†ÙŠÙ‡ Ø¥Ø³ØªØ±Ù„ÙŠÙ†ÙŠ',en:'British Pound'},rate:'0.2100'},
    {code:'AED',name:{ar:'Ø¯Ø±Ù‡Ù… Ø¥Ù…Ø§Ø±Ø§ØªÙŠ',en:'UAE Dirham'},rate:'0.9797'},
    {code:'KWD',name:{ar:'Ø¯ÙŠÙ†Ø§Ø± ÙƒÙˆÙŠØªÙŠ',en:'Kuwaiti Dinar'},rate:'0.0819'},
  ];
  document.getElementById('modalBody').innerHTML=`
    <div class="table-card"><div class="table-wrap">
      <table>
        <thead><tr>
          <th>${S.lang==='ar'?'Ø§Ù„Ø±Ù…Ø²':'Code'}</th>
          <th>${S.lang==='ar'?'Ø§Ù„Ø¹Ù…Ù„Ø©':'Currency'}</th>
          <th style="text-align:end">${S.lang==='ar'?'Ø³Ø¹Ø± Ø§Ù„ØµØ±Ù (Ù…Ù‚Ø§Ø¨Ù„ Ø§Ù„Ø±ÙŠØ§Ù„)':'Exchange Rate (vs SAR)'}</th>
          <th>${S.lang==='ar'?'Ø§Ù„Ø­Ø§Ù„Ø©':'Status'}</th>
          <th>${S.lang==='ar'?'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª':'Actions'}</th>
        </tr></thead>
        <tbody>
          ${curr.map(c=>`<tr>
            <td><strong>${c.code}</strong></td>
            <td>${t(c.name)}</td>
            <td style="text-align:end;font-weight:700">${c.rate}</td>
            <td>${c.default?`<span class="badge badge-green">âœ“ ${S.lang==='ar'?'Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©':'Default'}</span>`:`<span class="badge badge-blue">${S.lang==='ar'?'Ù†Ø´Ø·Ø©':'Active'}</span>`}</td>
            <td><button class="btn-icon">âœï¸</button></td>
          </tr>`).join('')}
        </tbody>
      </table>
    </div></div>
  `;
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ADDITIONAL PAGE RENDERS â€” All sections fully implemented
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function renderPurchaseInvoices(){
  document.getElementById('modalToolbar').innerHTML=`
    <button class="btn btn-primary" onclick="showToast('info','${S.lang==='ar'?'ÙØ§ØªÙˆØ±Ø© Ù…Ø´ØªØ±ÙŠØ§Øª Ø¬Ø¯ÙŠØ¯Ø©':'New purchase invoice'}','ğŸ“¦')">
      â• ${S.lang==='ar'?'ÙØ§ØªÙˆØ±Ø© Ù…Ø´ØªØ±ÙŠØ§Øª Ø¬Ø¯ÙŠØ¯Ø©':'New Purchase Invoice'}
    </button>
    <select class="btn btn-ghost" style="cursor:pointer">
      <option>${S.lang==='ar'?'ÙƒÙ„ Ø§Ù„ÙÙˆØ§ØªÙŠØ±':'All Invoices'}</option>
      <option>${S.lang==='ar'?'Ù…Ø¯ÙÙˆØ¹Ø©':'Paid'}</option>
      <option>${S.lang==='ar'?'Ù…Ø¹Ù„Ù‚Ø©':'Pending'}</option>
    </select>
    <button class="btn btn-ghost">ğŸ“¤ ${S.lang==='ar'?'ØªØµØ¯ÙŠØ±':'Export'}</button>
  `;
  const purchases=[
    {no:'PUR-2024-015',supplier:{ar:'Ù…Ø¤Ø³Ø³Ø© Ø§Ù„ØªÙˆØ±ÙŠØ¯ Ø§Ù„ÙˆØ·Ù†ÙŠ',en:'National Supply Est.'},amount:'SAR 42,000',date:'2026-02-15',due:'2026-03-15',status:'pending'},
    {no:'PUR-2024-014',supplier:{ar:'Ø´Ø±ÙƒØ© Ø§Ù„Ø¥Ù…Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ©',en:'Industrial Supplies Co.'},amount:'SAR 28,500',date:'2026-02-10',due:'2026-03-10',status:'paid'},
    {no:'PUR-2024-013',supplier:{ar:'Ù…Ø¤Ø³Ø³Ø© Ø§Ù„ØªØ¬Ù‡ÙŠØ²Ø§Øª Ø§Ù„Ù…ÙƒØªØ¨ÙŠØ©',en:'Office Equipment Est.'},amount:'SAR 15,200',date:'2026-02-08',due:'2026-03-08',status:'paid'},
    {no:'PUR-2024-012',supplier:{ar:'Ø´Ø±ÙƒØ© Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø®Ø§Ù…',en:'Raw Materials Co.'},amount:'SAR 67,800',date:'2026-02-05',due:'2026-03-05',status:'pending'},
  ];
  document.getElementById('modalBody').innerHTML=`
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1rem;margin-bottom:1.5rem">
      <div class="kpi">
        <div class="kpi-top"><div class="kpi-icon">ğŸ“¦</div><div class="kpi-badge up">+4</div></div>
        <div class="kpi-val">18</div><div class="kpi-label">${S.lang==='ar'?'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª':'Total Purchases'}</div>
      </div>
      <div class="kpi">
        <div class="kpi-top"><div class="kpi-icon">âœ…</div><div class="kpi-badge up">85%</div></div>
        <div class="kpi-val">SAR 153,500</div><div class="kpi-label">${S.lang==='ar'?'Ù…Ø¯ÙÙˆØ¹Ø©':'Paid'}</div>
      </div>
      <div class="kpi">
        <div class="kpi-top"><div class="kpi-icon">â³</div><div class="kpi-badge warn">2</div></div>
        <div class="kpi-val">SAR 109,800</div><div class="kpi-label">${S.lang==='ar'?'Ù…Ø¹Ù„Ù‚Ø©':'Pending'}</div>
      </div>
    </div>
    <div class="table-card"><div class="table-wrap">
      <table><thead><tr>
        <th>${S.lang==='ar'?'Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©':'Invoice #'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„Ù…ÙˆØ±Ø¯':'Supplier'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„Ù…Ø¨Ù„Øº':'Amount'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„ØªØ§Ø±ÙŠØ®':'Date'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚':'Due'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„Ø­Ø§Ù„Ø©':'Status'}</th>
        <th>${S.lang==='ar'?'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª':'Actions'}</th>
      </tr></thead><tbody>
        ${purchases.map(p=>`<tr>
          <td><strong style="color:var(--primary)">${p.no}</strong></td>
          <td>${t(p.supplier)}</td>
          <td><strong>${p.amount}</strong></td>
          <td>${p.date}</td><td>${p.due}</td>
          <td><span class="badge ${STATUS_MAP[p.status].cls}">${t(STATUS_MAP[p.status])}</span></td>
          <td>
            <button class="btn-icon" onclick="showToast('info','${p.no}','ğŸ‘ï¸')">ğŸ‘ï¸</button>
            <button class="btn-icon">ğŸ–¨ï¸</button>
          </td>
        </tr>`).join('')}
      </tbody></table>
    </div></div>
  `;
}

function renderSuppliers(){
  document.getElementById('modalToolbar').innerHTML=`
    <button class="btn btn-primary">â• ${S.lang==='ar'?'Ù…ÙˆØ±Ø¯ Ø¬Ø¯ÙŠØ¯':'New Supplier'}</button>
    <button class="btn btn-ghost">ğŸ“¤ ${S.lang==='ar'?'ØªØµØ¯ÙŠØ±':'Export'}</button>
    <input placeholder="${S.lang==='ar'?'Ø¨Ø­Ø«...':'Search...'}" style="width:200px;height:36px">
  `;
  const suppliers=[
    {name:{ar:'Ù…Ø¤Ø³Ø³Ø© Ø§Ù„ØªÙˆØ±ÙŠØ¯ Ø§Ù„ÙˆØ·Ù†ÙŠ',en:'National Supply Est.'},code:'S-001',balance:'SAR 42,000',status:'active',cat:{ar:'Ù…ÙˆØ§Ø¯ Ø®Ø§Ù…',en:'Raw Materials'}},
    {name:{ar:'Ø´Ø±ÙƒØ© Ø§Ù„Ø¥Ù…Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ©',en:'Industrial Supplies'},code:'S-002',balance:'SAR 15,800',status:'active',cat:{ar:'Ù‚Ø·Ø¹ ØºÙŠØ§Ø±',en:'Spare Parts'}},
    {name:{ar:'Ù…Ø¤Ø³Ø³Ø© Ø§Ù„ØªØ¬Ù‡ÙŠØ²Ø§Øª Ø§Ù„Ù…ÙƒØªØ¨ÙŠØ©',en:'Office Equipment'},code:'S-003',balance:'SAR 8,200',status:'pending',cat:{ar:'Ø£Ø«Ø§Ø« ÙˆÙ…Ø¹Ø¯Ø§Øª',en:'Furniture'}},
    {name:{ar:'Ø´Ø±ÙƒØ© Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø®Ø§Ù… Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©',en:'Advanced Materials Co.'},code:'S-004',balance:'SAR 67,500',status:'active',cat:{ar:'Ù…ÙˆØ§Ø¯ Ø¨Ù†Ø§Ø¡',en:'Construction'}},
  ];
  document.getElementById('modalBody').innerHTML=`
    <div style="display:grid;gap:1rem">
      ${suppliers.map(s=>`
        <div class="overview-card" style="background:var(--bg-card);border:1px solid var(--border);border-radius:var(--r16);padding:1.1rem;display:flex;align-items:center;gap:1rem;transition:all .3s;cursor:pointer"
          onmouseenter="this.style.transform='translateY(-3px)';this.style.boxShadow='var(--shadow-lg)'"
          onmouseleave="this.style.transform='';this.style.boxShadow=''">
          <div class="avatar" style="background:var(--grad-gold)">${t(s.name).charAt(0)}</div>
          <div style="flex:1">
            <div style="font-weight:700;margin-bottom:.2rem">${t(s.name)}</div>
            <div style="font-size:.78rem;color:var(--text3)">${s.code} Â· ${t(s.cat)}</div>
          </div>
          <div style="text-align:end">
            <div style="font-weight:700;color:var(--red)">${s.balance}</div>
            <span class="badge ${s.status==='active'?'badge-green':'badge-amber'}">${s.status==='active'?(S.lang==='ar'?'Ù†Ø´Ø·':'Active'):(S.lang==='ar'?'Ù…Ø¹Ù„Ù‚':'Pending')}</span>
          </div>
          <button class="btn-icon">ğŸ‘ï¸</button>
        </div>
      `).join('')}
    </div>
  `;
}

function renderReceipts(){
  document.getElementById('modalToolbar').innerHTML=`
    <button class="btn btn-primary">â• ${S.lang==='ar'?'Ø³Ù†Ø¯ Ù‚Ø¨Ø¶ Ø¬Ø¯ÙŠØ¯':'New Receipt'}</button>
    <button class="btn btn-ghost">ğŸ–¨ï¸ ${S.lang==='ar'?'Ø·Ø¨Ø§Ø¹Ø©':'Print'}</button>
  `;
  const receipts=[
    {no:'REC-2024-010',customer:{ar:'Ø´Ø±ÙƒØ© Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©',en:'Elite Trading'},amount:'SAR 85,500',date:'2026-02-16',method:{ar:'ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ',en:'Bank Transfer'},ref:'INV-2024-001'},
    {no:'REC-2024-009',customer:{ar:'Ù…Ø¤Ø³Ø³Ø© Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø­Ø¯ÙŠØ«Ø©',en:'Modern Tech'},amount:'SAR 42,000',date:'2026-02-13',method:{ar:'Ø´ÙŠÙƒ',en:'Cheque'},ref:'INV-2024-002'},
    {no:'REC-2024-008',customer:{ar:'Ø´Ø±ÙƒØ© Ø§Ù„Ø®Ù„ÙŠØ¬ Ù„Ù„ØªØ¬Ø§Ø±Ø©',en:'Gulf Commerce'},amount:'SAR 30,000',date:'2026-02-10',method:{ar:'Ù†Ù‚Ø¯Ø§Ù‹',en:'Cash'},ref:'INV-2024-005'},
    {no:'REC-2024-007',customer:{ar:'Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø¯ÙˆÙ„ÙŠØ©',en:'Intl Business'},amount:'SAR 28,400',date:'2026-02-08',method:{ar:'ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ',en:'Bank Transfer'},ref:'INV-2024-004'},
  ];
  document.getElementById('modalBody').innerHTML=`
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:1rem;margin-bottom:1.5rem">
      <div class="kpi">
        <div class="kpi-top"><div class="kpi-icon">ğŸ’µ</div><div class="kpi-badge up">+12%</div></div>
        <div class="kpi-val">SAR 185,900</div><div class="kpi-label">${S.lang==='ar'?'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù‚Ø¨ÙˆØ¶Ø§Øª Ø§Ù„ÙŠÙˆÙ…':'Today Total'}</div>
      </div>
      <div class="kpi">
        <div class="kpi-top"><div class="kpi-icon">ğŸ¦</div></div>
        <div class="kpi-val">12</div><div class="kpi-label">${S.lang==='ar'?'Ø³Ù†Ø¯Ø§Øª Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±':'This Month'}</div>
      </div>
    </div>
    <div class="table-card"><div class="table-wrap">
      <table><thead><tr>
        <th>${S.lang==='ar'?'Ø±Ù‚Ù… Ø§Ù„Ø³Ù†Ø¯':'Receipt #'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„Ø¹Ù…ÙŠÙ„':'Customer'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„Ù…Ø¨Ù„Øº':'Amount'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„ØªØ§Ø±ÙŠØ®':'Date'}</th>
        <th>${S.lang==='ar'?'Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹':'Method'}</th>
        <th>${S.lang==='ar'?'Ù…Ù‚Ø§Ø¨Ù„':'Ref'}</th>
        <th>${S.lang==='ar'?'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª':'Actions'}</th>
      </tr></thead><tbody>
        ${receipts.map(r=>`<tr>
          <td><strong style="color:var(--emerald)">${r.no}</strong></td>
          <td>${t(r.customer)}</td>
          <td><strong>${r.amount}</strong></td>
          <td>${r.date}</td>
          <td>${t(r.method)}</td>
          <td><code style="font-size:.8rem;color:var(--primary)">${r.ref}</code></td>
          <td>
            <button class="btn-icon">ğŸ‘ï¸</button>
            <button class="btn-icon">ğŸ–¨ï¸</button>
          </td>
        </tr>`).join('')}
      </tbody></table>
    </div></div>
  `;
}

function renderPayments(){
  document.getElementById('modalToolbar').innerHTML=`
    <button class="btn btn-primary">â• ${S.lang==='ar'?'Ø³Ù†Ø¯ ØµØ±Ù Ø¬Ø¯ÙŠØ¯':'New Payment'}</button>
    <button class="btn btn-ghost">ğŸ–¨ï¸ ${S.lang==='ar'?'Ø·Ø¨Ø§Ø¹Ø©':'Print'}</button>
  `;
  const payments=[
    {no:'PAY-2024-012',supplier:{ar:'Ù…Ø¤Ø³Ø³Ø© Ø§Ù„ØªÙˆØ±ÙŠØ¯ Ø§Ù„ÙˆØ·Ù†ÙŠ',en:'National Supply'},amount:'SAR 42,000',date:'2026-02-15',method:{ar:'ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ',en:'Bank Transfer'},ref:'PUR-2024-015'},
    {no:'PAY-2024-011',desc:{ar:'Ø±ÙˆØ§ØªØ¨ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',en:'Staff Salaries'},amount:'SAR 85,000',date:'2026-02-10',method:{ar:'ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ',en:'Bank Transfer'},ref:'â€”'},
    {no:'PAY-2024-010',supplier:{ar:'Ø´Ø±ÙƒØ© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡',en:'Electricity Co.'},amount:'SAR 8,200',date:'2026-02-08',method:{ar:'Ø´ÙŠÙƒ',en:'Cheque'},ref:'UTIL-001'},
    {no:'PAY-2024-009',desc:{ar:'Ø¥ÙŠØ¬Ø§Ø± Ø§Ù„Ù…ÙƒØªØ¨',en:'Office Rent'},amount:'SAR 45,000',date:'2026-02-05',method:{ar:'ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ',en:'Bank Transfer'},ref:'RENT-Q1'},
  ];
  document.getElementById('modalBody').innerHTML=`
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:1rem;margin-bottom:1.5rem">
      <div class="kpi">
        <div class="kpi-top"><div class="kpi-icon">ğŸ’³</div><div class="kpi-badge down">-8%</div></div>
        <div class="kpi-val">SAR 180,200</div><div class="kpi-label">${S.lang==='ar'?'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª Ø§Ù„ÙŠÙˆÙ…':'Today Total'}</div>
      </div>
      <div class="kpi">
        <div class="kpi-top"><div class="kpi-icon">ğŸ“‹</div></div>
        <div class="kpi-val">15</div><div class="kpi-label">${S.lang==='ar'?'Ø³Ù†Ø¯Ø§Øª Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±':'This Month'}</div>
      </div>
    </div>
    <div class="table-card"><div class="table-wrap">
      <table><thead><tr>
        <th>${S.lang==='ar'?'Ø±Ù‚Ù… Ø§Ù„Ø³Ù†Ø¯':'Payment #'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ / Ø§Ù„Ø¨ÙŠØ§Ù†':'Payee / Desc'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„Ù…Ø¨Ù„Øº':'Amount'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„ØªØ§Ø±ÙŠØ®':'Date'}</th>
        <th>${S.lang==='ar'?'Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹':'Method'}</th>
        <th>${S.lang==='ar'?'Ù…Ù‚Ø§Ø¨Ù„':'Ref'}</th>
        <th>${S.lang==='ar'?'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª':'Actions'}</th>
      </tr></thead><tbody>
        ${payments.map(p=>`<tr>
          <td><strong style="color:var(--red)">${p.no}</strong></td>
          <td>${t(p.supplier||p.desc)}</td>
          <td><strong>${p.amount}</strong></td>
          <td>${p.date}</td>
          <td>${t(p.method)}</td>
          <td><code style="font-size:.8rem">${p.ref}</code></td>
          <td>
            <button class="btn-icon">ğŸ‘ï¸</button>
            <button class="btn-icon">ğŸ–¨ï¸</button>
          </td>
        </tr>`).join('')}
      </tbody></table>
    </div></div>
  `;
}

function renderStockMovement(){
  document.getElementById('modalToolbar').innerHTML=`
    <button class="btn btn-primary">â• ${S.lang==='ar'?'Ø­Ø±ÙƒØ© Ø¬Ø¯ÙŠØ¯Ø©':'New Movement'}</button>
    <select class="btn btn-ghost" style="cursor:pointer">
      <option>${S.lang==='ar'?'ÙƒÙ„ Ø§Ù„Ø­Ø±ÙƒØ§Øª':'All Movements'}</option>
      <option>${S.lang==='ar'?'Ø¥Ø¯Ø®Ø§Ù„':'In'}</option>
      <option>${S.lang==='ar'?'Ø¥Ø®Ø±Ø§Ø¬':'Out'}</option>
      <option>${S.lang==='ar'?'ØªØ­ÙˆÙŠÙ„':'Transfer'}</option>
    </select>
  `;
  const movements=[
    {no:'SM-2024-047',type:{ar:'Ø¥Ø¯Ø®Ø§Ù„',en:'Stock In'},product:{ar:'Ù„Ø§Ø¨ØªÙˆØ¨ HP ProBook',en:'HP ProBook'},qty:'+15',date:'2026-02-16',ref:'PUR-2024-015',cls:'badge-green'},
    {no:'SM-2024-046',type:{ar:'Ø¥Ø®Ø±Ø§Ø¬',en:'Stock Out'},product:{ar:'Ø·Ø§Ø¨Ø¹Ø© Canon LBP',en:'Canon Printer'},qty:'-3',date:'2026-02-15',ref:'INV-2024-001',cls:'badge-red'},
    {no:'SM-2024-045',type:{ar:'ØªØ­ÙˆÙŠÙ„',en:'Transfer'},product:{ar:'Ù…Ø§ÙˆØ³ Ù„Ø§Ø³Ù„ÙƒÙŠ',en:'Wireless Mouse'},qty:'20',date:'2026-02-14',ref:'WH-Aâ†’WH-B',cls:'badge-blue'},
    {no:'SM-2024-044',type:{ar:'Ø¥Ø®Ø±Ø§Ø¬',en:'Stock Out'},product:{ar:'Ø´Ø§Ø´Ø© Samsung 24"',en:'Samsung Monitor'},qty:'-5',date:'2026-02-13',ref:'INV-2024-003',cls:'badge-red'},
    {no:'SM-2024-043',type:{ar:'Ø¥Ø¯Ø®Ø§Ù„',en:'Stock In'},product:{ar:'ÙÙ„Ø§Ø´ Ø¯ÙŠØ³Ùƒ 64GB',en:'Flash Drive 64GB'},qty:'+50',date:'2026-02-12',ref:'PUR-2024-014',cls:'badge-green'},
  ];
  document.getElementById('modalBody').innerHTML=`
    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;margin-bottom:1.5rem">
      <div class="kpi">
        <div class="kpi-top"><div class="kpi-icon">ğŸ“¥</div><div class="kpi-badge up">+65</div></div>
        <div class="kpi-val">18</div><div class="kpi-label">${S.lang==='ar'?'Ø­Ø±ÙƒØ§Øª Ø¥Ø¯Ø®Ø§Ù„':'Stock In'}</div>
      </div>
      <div class="kpi">
        <div class="kpi-top"><div class="kpi-icon">ğŸ“¤</div><div class="kpi-badge down">-42</div></div>
        <div class="kpi-val">23</div><div class="kpi-label">${S.lang==='ar'?'Ø­Ø±ÙƒØ§Øª Ø¥Ø®Ø±Ø§Ø¬':'Stock Out'}</div>
      </div>
      <div class="kpi">
        <div class="kpi-top"><div class="kpi-icon">ğŸ”„</div><div class="kpi-badge">6</div></div>
        <div class="kpi-val">6</div><div class="kpi-label">${S.lang==='ar'?'ØªØ­ÙˆÙŠÙ„Ø§Øª':'Transfers'}</div>
      </div>
    </div>
    <div class="table-card"><div class="table-wrap">
      <table><thead><tr>
        <th>${S.lang==='ar'?'Ø±Ù‚Ù… Ø§Ù„Ø­Ø±ÙƒØ©':'Mvmt #'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„Ù†ÙˆØ¹':'Type'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„Ù…Ù†ØªØ¬':'Product'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„ÙƒÙ…ÙŠØ©':'Qty'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„ØªØ§Ø±ÙŠØ®':'Date'}</th>
        <th>${S.lang==='ar'?'Ù…Ø±Ø¬Ø¹':'Ref'}</th>
        <th>${S.lang==='ar'?'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª':'Actions'}</th>
      </tr></thead><tbody>
        ${movements.map(m=>`<tr>
          <td><strong>${m.no}</strong></td>
          <td><span class="badge ${m.cls}">${t(m.type)}</span></td>
          <td>${t(m.product)}</td>
          <td><strong style="color:${m.qty.startsWith('+')?'var(--emerald)':m.qty.startsWith('-')?'var(--red)':'var(--blue)'}">${m.qty}</strong></td>
          <td>${m.date}</td>
          <td><code style="font-size:.8rem">${m.ref}</code></td>
          <td><button class="btn-icon">ğŸ‘ï¸</button></td>
        </tr>`).join('')}
      </tbody></table>
    </div></div>
  `;
}

function renderUsers(){
  document.getElementById('modalToolbar').innerHTML=`
    <button class="btn btn-primary">â• ${S.lang==='ar'?'Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯':'New User'}</button>
    <button class="btn btn-ghost">ğŸ‘¥ ${S.lang==='ar'?'Ø§Ù„Ø£Ø¯ÙˆØ§Ø±':'Roles'}</button>
  `;
  const users=[
    {name:{ar:'Ù…Ø­Ù…Ø¯ ØµØ§Ù„Ø­',en:'Mohamed Salah'},email:'m.salah@company.sa',role:{ar:'Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…',en:'Administrator'},status:'active',last:{ar:'Ù…Ù†Ø° 5 Ø¯Ù‚Ø§Ø¦Ù‚',en:'5 min ago'}},
    {name:{ar:'Ø£Ø­Ù…Ø¯ Ø¹Ù„ÙŠ',en:'Ahmed Ali'},email:'a.ali@company.sa',role:{ar:'Ù…Ø­Ø§Ø³Ø¨',en:'Accountant'},status:'active',last:{ar:'Ù…Ù†Ø° Ø³Ø§Ø¹Ø©',en:'1 hour ago'}},
    {name:{ar:'ÙØ§Ø·Ù…Ø© Ù…Ø­Ù…Ø¯',en:'Fatima Mohamed'},email:'f.mohamed@company.sa',role:{ar:'Ù…Ø¯ÙŠØ± Ù…Ø¨ÙŠØ¹Ø§Øª',en:'Sales Manager'},status:'active',last:{ar:'Ù…Ù†Ø° 3 Ø³Ø§Ø¹Ø§Øª',en:'3 hours ago'}},
    {name:{ar:'Ø®Ø§Ù„Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡',en:'Khaled Abdullah'},email:'k.abdullah@company.sa',role:{ar:'Ø£Ù…ÙŠÙ† Ù…Ø®Ø²Ù†',en:'Storekeeper'},status:'inactive',last:{ar:'Ù…Ù†Ø° ÙŠÙˆÙ…ÙŠÙ†',en:'2 days ago'}},
  ];
  document.getElementById('modalBody').innerHTML=`
    <div style="display:grid;gap:1rem">
      ${users.map(u=>`
        <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:var(--r16);padding:1.25rem;display:flex;align-items:center;gap:1.25rem;transition:all .3s"
          onmouseenter="this.style.transform='translateY(-2px)';this.style.boxShadow='var(--shadow-md)'"
          onmouseleave="this.style.transform='';this.style.boxShadow=''">
          <div class="avatar" style="width:48px;height:48px;font-size:1.1rem">${t(u.name).charAt(0)}</div>
          <div style="flex:1">
            <div style="font-weight:700;margin-bottom:.15rem">${t(u.name)}</div>
            <div style="font-size:.8rem;color:var(--text3);margin-bottom:.25rem">${u.email}</div>
            <div style="font-size:.75rem;color:var(--text3)">${t(u.role)} Â· ${t(u.last)}</div>
          </div>
          <div style="display:flex;align-items:center;gap:.75rem">
            <span class="badge ${u.status==='active'?'badge-green':'badge-amber'}">${u.status==='active'?(S.lang==='ar'?'Ù†Ø´Ø·':'Active'):(S.lang==='ar'?'ØºÙŠØ± Ù†Ø´Ø·':'Inactive')}</span>
            <button class="btn-icon">âœï¸</button>
            <button class="btn-icon">ğŸ”’</button>
          </div>
        </div>
      `).join('')}
    </div>
    <div style="margin-top:1.5rem;padding:1rem;background:var(--grad-card);border-radius:var(--r12);border:1px solid var(--border)">
      <strong style="display:block;margin-bottom:.5rem">${S.lang==='ar'?'ğŸ“Œ Ø§Ù„Ø£Ø¯ÙˆØ§Ø± ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª':'ğŸ“Œ Roles & Permissions'}</strong>
      <div style="display:flex;gap:.5rem;flex-wrap:wrap;font-size:.85rem">
        <span class="badge badge-blue">${S.lang==='ar'?'Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…':'Administrator'}</span>
        <span class="badge badge-green">${S.lang==='ar'?'Ù…Ø­Ø§Ø³Ø¨':'Accountant'}</span>
        <span class="badge badge-purple">${S.lang==='ar'?'Ù…Ø¯ÙŠØ± Ù…Ø¨ÙŠØ¹Ø§Øª':'Sales Manager'}</span>
        <span class="badge badge-amber">${S.lang==='ar'?'Ø£Ù…ÙŠÙ† Ù…Ø®Ø²Ù†':'Storekeeper'}</span>
      </div>
    </div>
  `;
}

function renderSalesReturns(){
  document.getElementById('modalToolbar').innerHTML=`
    <button class="btn btn-primary">â• ${S.lang==='ar'?'Ù…Ø±Ø¯ÙˆØ¯ Ù…Ø¨ÙŠØ¹Ø§Øª Ø¬Ø¯ÙŠØ¯':'New Sales Return'}</button>
    <button class="btn btn-ghost">ğŸ“Š ${S.lang==='ar'?'Ø§Ù„ØªÙ‚Ø±ÙŠØ±':'Report'}</button>
  `;
  const returns=[
    {no:'SR-2024-003',customer:{ar:'Ø´Ø±ÙƒØ© Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©',en:'Elite Trading'},amount:'SAR 5,200',date:'2026-02-14',ref:'INV-2024-001',reason:{ar:'Ø¹ÙŠØ¨ ØªØµÙ†ÙŠØ¹',en:'Manufacturing defect'},status:'approved'},
    {no:'SR-2024-002',customer:{ar:'Ù…Ø¤Ø³Ø³Ø© Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø­Ø¯ÙŠØ«Ø©',en:'Modern Tech'},amount:'SAR 3,800',date:'2026-02-10',ref:'INV-2024-002',reason:{ar:'Ø·Ù„Ø¨ Ø§Ù„Ø¹Ù…ÙŠÙ„',en:'Customer request'},status:'pending'},
    {no:'SR-2024-001',customer:{ar:'Ø´Ø±ÙƒØ© Ø§Ù„Ø®Ù„ÙŠØ¬ Ù„Ù„ØªØ¬Ø§Ø±Ø©',en:'Gulf Commerce'},amount:'SAR 2,100',date:'2026-02-05',ref:'INV-2024-005',reason:{ar:'Ù…ÙˆØ§ØµÙØ§Øª Ø®Ø§Ø·Ø¦Ø©',en:'Wrong specs'},status:'approved'},
  ];
  document.getElementById('modalBody').innerHTML=`
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-bottom:1.5rem">
      <div class="kpi">
        <div class="kpi-top"><div class="kpi-icon">â†©ï¸</div><div class="kpi-badge warn">3</div></div>
        <div class="kpi-val">SAR 11,100</div><div class="kpi-label">${S.lang==='ar'?'Ù…Ø±Ø¯ÙˆØ¯Ø§Øª Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±':'This Month'}</div>
      </div>
      <div class="kpi">
        <div class="kpi-top"><div class="kpi-icon">ğŸ“Š</div></div>
        <div class="kpi-val">1.2%</div><div class="kpi-label">${S.lang==='ar'?'Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø±Ø¯ÙˆØ¯Ø§Øª':'Return Rate'}</div>
      </div>
    </div>
    <div class="table-card"><div class="table-wrap">
      <table><thead><tr>
        <th>${S.lang==='ar'?'Ø±Ù‚Ù… Ø§Ù„Ù…Ø±Ø¯ÙˆØ¯':'Return #'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„Ø¹Ù…ÙŠÙ„':'Customer'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„Ù…Ø¨Ù„Øº':'Amount'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„ØªØ§Ø±ÙŠØ®':'Date'}</th>
        <th>${S.lang==='ar'?'Ù…Ù‚Ø§Ø¨Ù„ ÙØ§ØªÙˆØ±Ø©':'Ref Invoice'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„Ø³Ø¨Ø¨':'Reason'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„Ø­Ø§Ù„Ø©':'Status'}</th>
        <th>${S.lang==='ar'?'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª':'Actions'}</th>
      </tr></thead><tbody>
        ${returns.map(r=>`<tr>
          <td><strong style="color:var(--amber)">${r.no}</strong></td>
          <td>${t(r.customer)}</td>
          <td><strong>${r.amount}</strong></td>
          <td>${r.date}</td>
          <td><code style="font-size:.8rem;color:var(--primary)">${r.ref}</code></td>
          <td style="font-size:.85rem">${t(r.reason)}</td>
          <td><span class="badge ${r.status==='approved'?'badge-green':'badge-amber'}">${r.status==='approved'?(S.lang==='ar'?'Ù…Ø¹ØªÙ…Ø¯':'Approved'):(S.lang==='ar'?'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©':'Pending')}</span></td>
          <td>
            <button class="btn-icon">ğŸ‘ï¸</button>
            <button class="btn-icon">ğŸ–¨ï¸</button>
          </td>
        </tr>`).join('')}
      </tbody></table>
    </div></div>
  `;
}

function renderPurchaseReturns(){
  document.getElementById('modalToolbar').innerHTML=`
    <button class="btn btn-primary">â• ${S.lang==='ar'?'Ù…Ø±Ø¯ÙˆØ¯ Ù…Ø´ØªØ±ÙŠØ§Øª Ø¬Ø¯ÙŠØ¯':'New Purchase Return'}</button>
    <button class="btn btn-ghost">ğŸ“Š ${S.lang==='ar'?'Ø§Ù„ØªÙ‚Ø±ÙŠØ±':'Report'}</button>
  `;
  const returns=[
    {no:'PR-2024-002',supplier:{ar:'Ù…Ø¤Ø³Ø³Ø© Ø§Ù„ØªÙˆØ±ÙŠØ¯ Ø§Ù„ÙˆØ·Ù†ÙŠ',en:'National Supply'},amount:'SAR 8,500',date:'2026-02-12',ref:'PUR-2024-015',reason:{ar:'Ø¨Ø¶Ø§Ø¹Ø© ØªØ§Ù„ÙØ©',en:'Damaged goods'},status:'approved'},
    {no:'PR-2024-001',supplier:{ar:'Ø´Ø±ÙƒØ© Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø®Ø§Ù…',en:'Raw Materials Co.'},amount:'SAR 4,200',date:'2026-02-08',ref:'PUR-2024-012',reason:{ar:'Ù…ÙˆØ§ØµÙØ§Øª ØºÙŠØ± Ù…Ø·Ø§Ø¨Ù‚Ø©',en:'Non-conforming specs'},status:'pending'},
  ];
  document.getElementById('modalBody').innerHTML=`
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-bottom:1.5rem">
      <div class="kpi">
        <div class="kpi-top"><div class="kpi-icon">ğŸ”„</div><div class="kpi-badge warn">2</div></div>
        <div class="kpi-val">SAR 12,700</div><div class="kpi-label">${S.lang==='ar'?'Ù…Ø±Ø¯ÙˆØ¯Ø§Øª Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±':'This Month'}</div>
      </div>
      <div class="kpi">
        <div class="kpi-top"><div class="kpi-icon">ğŸ“Š</div></div>
        <div class="kpi-val">2.8%</div><div class="kpi-label">${S.lang==='ar'?'Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø±Ø¯ÙˆØ¯Ø§Øª':'Return Rate'}</div>
      </div>
    </div>
    <div class="table-card"><div class="table-wrap">
      <table><thead><tr>
        <th>${S.lang==='ar'?'Ø±Ù‚Ù… Ø§Ù„Ù…Ø±Ø¯ÙˆØ¯':'Return #'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„Ù…ÙˆØ±Ø¯':'Supplier'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„Ù…Ø¨Ù„Øº':'Amount'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„ØªØ§Ø±ÙŠØ®':'Date'}</th>
        <th>${S.lang==='ar'?'Ù…Ù‚Ø§Ø¨Ù„ ÙØ§ØªÙˆØ±Ø©':'Ref Invoice'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„Ø³Ø¨Ø¨':'Reason'}</th>
        <th>${S.lang==='ar'?'Ø§Ù„Ø­Ø§Ù„Ø©':'Status'}</th>
        <th>${S.lang==='ar'?'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª':'Actions'}</th>
      </tr></thead><tbody>
        ${returns.map(r=>`<tr>
          <td><strong style="color:var(--purple)">${r.no}</strong></td>
          <td>${t(r.supplier)}</td>
          <td><strong>${r.amount}</strong></td>
          <td>${r.date}</td>
          <td><code style="font-size:.8rem;color:var(--primary)">${r.ref}</code></td>
          <td style="font-size:.85rem">${t(r.reason)}</td>
          <td><span class="badge ${r.status==='approved'?'badge-green':'badge-amber'}">${r.status==='approved'?(S.lang==='ar'?'Ù…Ø¹ØªÙ…Ø¯':'Approved'):(S.lang==='ar'?'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©':'Pending')}</span></td>
          <td>
            <button class="btn-icon">ğŸ‘ï¸</button>
            <button class="btn-icon">ğŸ–¨ï¸</button>
          </td>
        </tr>`).join('')}
      </tbody></table>
    </div></div>
  `;
}

function renderWarehouseReport(){
  document.getElementById('modalToolbar').innerHTML=`
    <select class="btn btn-ghost" style="cursor:pointer">
      <option>${S.lang==='ar'?'Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ':'Main Warehouse'}</option>
      <option>${S.lang==='ar'?'Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„ÙØ±Ø¹ÙŠ Ø£':'Branch Warehouse A'}</option>
      <option>${S.lang==='ar'?'Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„ÙØ±Ø¹ÙŠ Ø¨':'Branch Warehouse B'}</option>
    </select>
    <button class="btn btn-ghost">ğŸ“Š ${S.lang==='ar'?'ØªØµØ¯ÙŠØ± Excel':'Export Excel'}</button>
    <button class="btn btn-primary">ğŸ”„ ${S.lang==='ar'?'ØªØ­Ø¯ÙŠØ«':'Refresh'}</button>
  `;
  const inventory=[
    {cat:{ar:'Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª',en:'Electronics'},items:24,value:'SAR 185,400',util:78},
    {cat:{ar:'Ù…ÙˆØ§Ø¯ Ù…ÙƒØªØ¨ÙŠØ©',en:'Office Supplies'},items:156,value:'SAR 45,200',util:92},
    {cat:{ar:'Ù‚Ø·Ø¹ ØºÙŠØ§Ø±',en:'Spare Parts'},items:87,value:'SAR 67,800',util:65},
    {cat:{ar:'Ù…ÙˆØ§Ø¯ Ø®Ø§Ù…',en:'Raw Materials'},items:45,value:'SAR 128,500',util:54},
  ];
  document.getElementById('modalBody').innerHTML=`
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1rem;margin-bottom:1.5rem">
      <div class="kpi">
        <div class="kpi-top"><div class="kpi-icon">ğŸ“¦</div></div>
        <div class="kpi-val">312</div><div class="kpi-label">${S.lang==='ar'?'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ØµÙ†Ø§Ù':'Total Items'}</div>
      </div>
      <div class="kpi">
        <div class="kpi-top"><div class="kpi-icon">ğŸ’°</div></div>
        <div class="kpi-val">SAR 426,900</div><div class="kpi-label">${S.lang==='ar'?'Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ†':'Inventory Value'}</div>
      </div>
      <div class="kpi">
        <div class="kpi-top"><div class="kpi-icon">âš ï¸</div><div class="kpi-badge warn">8</div></div>
        <div class="kpi-val">8</div><div class="kpi-label">${S.lang==='ar'?'Ø£ØµÙ†Ø§Ù Ù…Ù†Ø®ÙØ¶Ø©':'Low Stock'}</div>
      </div>
      <div class="kpi">
        <div class="kpi-top"><div class="kpi-icon">ğŸ“Š</div></div>
        <div class="kpi-val">72%</div><div class="kpi-label">${S.lang==='ar'?'Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø§Ø³ØªØºÙ„Ø§Ù„':'Utilization'}</div>
      </div>
    </div>
    <div class="report-card">
      <div class="report-card-head"><strong>${S.lang==='ar'?'ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø©':'Inventory by Category'}</strong></div>
      <div style="padding:1rem">
        ${inventory.map(i=>`
          <div style="margin-bottom:1.25rem">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem">
              <div>
                <strong style="display:block;margin-bottom:.15rem">${t(i.cat)}</strong>
                <span style="font-size:.8rem;color:var(--text3)">${i.items} ${S.lang==='ar'?'ØµÙ†Ù':'items'} Â· ${i.value}</span>
              </div>
              <span style="font-weight:700;color:var(--primary)">${i.util}%</span>
            </div>
            <div class="prog-wrap" style="height:8px">
              <div class="prog-bar" style="width:${i.util}%;background:${i.util>80?'var(--emerald)':i.util>50?'var(--amber)':'var(--red)'}"></div>
            </div>
          </div>
        `).join('')}
      </div>
    </div>
    <div style="margin-top:1.5rem;padding:1.25rem;background:var(--grad-card);border-radius:var(--r16);border:1px solid var(--border)">
      <strong style="display:block;margin-bottom:.75rem">${S.lang==='ar'?'ğŸ“ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹':'ğŸ“ Warehouse Location'}</strong>
      <p style="font-size:.9rem;color:var(--text2);margin-bottom:.5rem">${S.lang==='ar'?'Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ - Ø§Ù„Ø±ÙŠØ§Ø¶':'Main Warehouse - Riyadh'}</p>
      <p style="font-size:.85rem;color:var(--text3)">${S.lang==='ar'?'Ø§Ù„Ù…Ø³Ø§Ø­Ø©: 2,500 Ù…Â² | Ø§Ù„Ø³Ø¹Ø©: 5,000 ØµÙ†Ù':'Area: 2,500 mÂ² | Capacity: 5,000 items'}</p>
    </div>
  `;
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SEARCH
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openSearch(){
  document.getElementById('searchOverlay').classList.add('open');
  setTimeout(()=>document.getElementById('searchInput').focus(),100);
  renderSearchResults('');
}

function closeSearch(){
  document.getElementById('searchOverlay').classList.remove('open');
  document.getElementById('searchInput').value='';
}

function renderSearchResults(q){
  const r=document.getElementById('searchResults');
  const filtered = q.trim()==='' ? SEARCH_DATA :
    SEARCH_DATA.filter(i=>
      t(i.label).toLowerCase().includes(q.toLowerCase())||
      t(i.sub).toLowerCase().includes(q.toLowerCase())
    );
  if(!filtered.length){
    r.innerHTML=`<div class="search-empty">${S.lang==='ar'?'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬':'No results found'}</div>`;
    return;
  }
  r.innerHTML=filtered.map((item,i)=>`
    <div class="search-item" tabindex="0" onclick="item_${i}()">
      <div class="search-item-icon">${item.icon}</div>
      <div>
        <div class="search-item-title">${t(item.label)}</div>
        <div class="search-item-sub">${t(item.sub)}</div>
      </div>
    </div>
  `).join('');
  // Bind actions
  filtered.forEach((item,i)=>{
    window[`item_${i}`]=()=>{ item.action(); closeSearch(); };
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TOAST SYSTEM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const TOAST_ICONS={success:'âœ…',error:'âŒ',warn:'âš ï¸',info:'â„¹ï¸'};
function showToast(type='info',msg='',icon=''){
  const wrap=document.getElementById('toastWrap');
  const el=document.createElement('div');
  el.className=`toast ${type}`;
  el.innerHTML=`
    <span class="toast-icon">${icon||TOAST_ICONS[type]}</span>
    <span class="toast-msg">${msg}</span>
    <button class="toast-close" onclick="this.closest('.toast').remove()">âœ•</button>
  `;
  wrap.appendChild(el);
  requestAnimationFrame(()=>el.classList.add('show'));
  setTimeout(()=>{ el.classList.remove('show'); setTimeout(()=>el.remove(),300); },4000);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ONBOARDING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const ONBOARD_STEPS=[
  {
    icon:'ğŸ’',
    ar:{ title:'Ù…Ø±Ø­Ø¨Ø§Ù‹ ÙÙŠ ÙÙŠ Ø¢ÙŠ Ø¨ÙŠ ÙØ±ÙˆÙ†Øª Ø£ÙƒÙˆÙ†ØªÙ†Ø¬!', desc:'Ù†Ø¸Ø§Ù… Ù…Ø­Ø§Ø³Ø¨ÙŠ ÙØ§Ø®Ø± Ù…ØµÙ…Ù… Ø®ØµÙŠØµØ§Ù‹ Ù„Ù„Ø´Ø±ÙƒØ§Øª Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© ÙˆØ§Ù„Ø®Ù„ÙŠØ¬ÙŠØ©. Ø¯Ø¹Ù†Ø§ Ù†Ø³Ø§Ø¹Ø¯Ùƒ Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø¯Ø¡.', btn:'Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯' },
    en:{ title:'Welcome to VIP Front Accounting!', desc:'A luxury accounting system designed specifically for Saudi & Gulf businesses. Let us help you get started.', btn:'Start Setup' }
  },
  {
    icon:'ğŸ¢',
    ar:{ title:'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø±ÙƒØ©', desc:'Ø£Ø¯Ø®Ù„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø´Ø±ÙƒØªÙƒ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„ØªØ¨Ø¯Ø£', btn:'Ø§Ù„ØªØ§Ù„ÙŠ', form:true },
    en:{ title:'Company Information', desc:'Enter your basic company information to get started', btn:'Next', form:true }
  },
  {
    icon:'ğŸ¯',
    ar:{ title:'Ø¬ÙˆÙ„Ø© Ø³Ø±ÙŠØ¹Ø©', desc:'ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø£Ù‡Ù… Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ù†Ø¸Ø§Ù… Ù‚Ø¨Ù„ Ø§Ù„Ø¨Ø¯Ø¡', btn:'Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯' },
    en:{ title:'Quick Tour', desc:'Get familiar with the main sections before you start', btn:'Finish Setup' }
  }
];

let onboardStep=0;

function startOnboarding(){
  // Wait for fonts and page to fully render before showing
  const show = () => {
    const wrap = document.getElementById('onboardWrap');
    if(wrap) {
      renderOnboardStep(0);
      // Small delay ensures fonts/styles are loaded = no blank white box
      requestAnimationFrame(() => {
        setTimeout(() => wrap.classList.add('show'), 120);
      });
    }
  };
  if(document.fonts) {
    document.fonts.ready.then(show);
  } else {
    setTimeout(show, 400);
  }
}

function renderOnboardStep(i){
  const step=ONBOARD_STEPS[i];
  if(!step) return;
  const meta=step[S.lang]||step.ar;
  const prog=document.getElementById('onboardProgress');
  if(prog) prog.innerHTML=ONBOARD_STEPS.map((_,j)=>`<div class="op-dot${j<=i?' done':''}"></div>`).join('');

  const content = document.getElementById('onboardContent');
  if(!content) return;

  content.innerHTML=`
    <div class="onboard-step active">
      <div class="onboard-icon">${step.icon}</div>
      <h2 style="font-size:1.3rem;font-weight:800;margin-bottom:.5rem;color:var(--text)">${meta.title}</h2>
      <p style="color:var(--text3);margin-bottom:1.25rem;line-height:1.7;font-size:.9rem">${meta.desc}</p>
      ${meta.form?`
        <div class="setup-form">
          <div class="field"><label style="font-size:.8rem;font-weight:600;color:var(--text2);display:block;margin-bottom:.35rem">${S.lang==='ar'?'Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)':'Company Name (optional)'}</label>
            <input style="width:100%;padding:.55rem .875rem;border:1.5px solid var(--border);border-radius:var(--r8);background:var(--bg-card);color:var(--text);font-family:var(--font);font-size:.875rem;outline:none;"
              placeholder="${S.lang==='ar'?'Ù…Ø«Ø§Ù„: Ø´Ø±ÙƒØ© Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©':'e.g. Elite Trading Co.'}">
          </div>
          <div class="field"><label style="font-size:.8rem;font-weight:600;color:var(--text2);display:block;margin-bottom:.35rem">${S.lang==='ar'?'Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©':'Base Currency'}</label>
            <select style="width:100%;padding:.55rem .875rem;border:1.5px solid var(--border);border-radius:var(--r8);background:var(--bg-card);color:var(--text);font-family:var(--font);font-size:.875rem;outline:none;">
              <option>SAR - Ø±ÙŠØ§Ù„ Ø³Ø¹ÙˆØ¯ÙŠ</option><option>USD - Ø¯ÙˆÙ„Ø§Ø± Ø£Ù…Ø±ÙŠÙƒÙŠ</option><option>EUR - ÙŠÙˆØ±Ùˆ</option>
            </select>
          </div>
        </div>
      `:''}
      <div style="display:flex;gap:.75rem;align-items:center;margin-top:1.25rem;flex-wrap:wrap;">
        <button class="btn btn-ghost btn-sm" onclick="finishOnboarding()"
          style="background:transparent;color:var(--text3);border:1px solid var(--border);padding:.45rem 1rem;border-radius:var(--r8);cursor:pointer;font-family:var(--font);font-size:.82rem;">
          ${S.lang==='ar'?'ØªØ®Ø·ÙŠ':'Skip'}
        </button>
        <div style="flex:1"></div>
        ${i>0?`<button class="btn btn-ghost btn-sm" onclick="renderOnboardStep(${i-1})"
          style="background:var(--bg);border:1px solid var(--border);padding:.45rem 1rem;border-radius:var(--r8);cursor:pointer;font-family:var(--font);font-size:.82rem;">
          â† ${S.lang==='ar'?'Ø±Ø¬ÙˆØ¹':'Back'}
        </button>`:''}
        <button onclick="${i<ONBOARD_STEPS.length-1?`renderOnboardStep(${i+1})`:'finishOnboarding()'}"
          style="background:var(--grad-main);color:#fff;border:none;padding:.5rem 1.25rem;border-radius:var(--r8);cursor:pointer;font-family:var(--font);font-size:.875rem;font-weight:700;box-shadow:var(--shadow-md);">
          ${meta.btn} ${i<ONBOARD_STEPS.length-1?'â†’':'âœ“'}
        </button>
      </div>
    </div>
  `;
}

function finishOnboarding(){
  localStorage.setItem('vfa-onboarded','1');
  S.onboarded=true;
  const wrap = document.getElementById('onboardWrap');
  wrap.classList.remove('show');
  setTimeout(()=>{ wrap.style.display='none'; },400);
  showToast('success',S.lang==='ar'?'Ù…Ø±Ø­Ø¨Ø§Ù‹! Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ğŸ‰':'Welcome! System ready to use ğŸ‰','ğŸ’');
  // Don't auto-open shortcuts - let user explore naturally
}

// â”€â”€ BTT & Scroll â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EVENTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function bindEvents(){
  // Theme
  document.getElementById('themeBtn').addEventListener('click',()=>applyDark(!S.dark));
  // Lang
  document.getElementById('langBtn').addEventListener('click',toggleLang);
  // Mobile toggle
  const mobileToggleBtn = document.getElementById('mobileToggle');
  mobileToggleBtn.addEventListener('click', () => {
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('sidebarOverlay');
    const isOpen = sidebar.classList.contains('open');
    if(isOpen){
      closeSidebar();
    } else {
      sidebar.classList.add('open');
      overlay.classList.add('open');
      mobileToggleBtn.textContent = 'âœ•';
      mobileToggleBtn.style.background = 'rgba(255,255,255,0.25)';
    }
  });
  // Search trigger
  document.getElementById('searchTrigger').addEventListener('click',openSearch);
  // Search input
  document.getElementById('searchInput').addEventListener('input',e=>renderSearchResults(e.target.value));
  document.getElementById('searchBackdrop').addEventListener('click',closeSearch);
  // Shortcuts button
  document.getElementById('shortcutBtn').addEventListener('click',()=>document.getElementById('shortcutOverlay').classList.add('open'));
  // Back to top
  window.addEventListener('scroll',()=>{
    document.getElementById('btt').classList.toggle('show',window.scrollY>300);
    document.getElementById('header').style.boxShadow=window.scrollY>10?'var(--shadow-xl)':'';
  },{passive:true});
  // Keyboard shortcuts
  document.addEventListener('keydown',e=>{
    const ctrl=e.ctrlKey||e.metaKey;
    if(ctrl&&e.key==='k'){e.preventDefault();openSearch();}
    if(ctrl&&e.key==='n'){e.preventDefault();openPage('salesInvoices');renderNewInvoiceForm&&renderNewInvoiceForm();}
    if(ctrl&&e.key==='/'||e.altKey&&e.key==='?'){e.preventDefault();document.getElementById('shortcutOverlay').classList.toggle('open');}
    if(e.altKey&&e.key==='d'){e.preventDefault();closeModal();showPage('dashboard');}
    if(e.altKey&&e.key==='l'){e.preventDefault();toggleLang();}
    if(e.key==='Escape'){
      if(document.getElementById('searchOverlay').classList.contains('open')){closeSearch();return;}
      if(document.getElementById('modalBackdrop').classList.contains('open')){closeModal();return;}
      closeShortcuts();
    }
  });
}

function closeShortcuts(e){
  if(!e||e.target===document.getElementById('shortcutOverlay'))
    document.getElementById('shortcutOverlay').classList.remove('open');
}
function closeSidebar(){
  document.getElementById('sidebar').classList.remove('open');
  document.getElementById('sidebarOverlay').classList.remove('open');
  const btn = document.getElementById('mobileToggle');
  if(btn){ btn.textContent = 'â˜°'; btn.style.background = ''; }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BOOT â€” Wait for DOM + Fonts before init
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
if(document.readyState === 'loading'){
  document.addEventListener('DOMContentLoaded', init);
} else {
  init();
}

// Console branding
console.log('%cğŸ’ VIP Front Accounting', 'font-size:22px;font-weight:800;background:linear-gradient(135deg,#004D40,#D4AF37);-webkit-background-clip:text;-webkit-text-fill-color:transparent;');
console.log('%cProduction-Ready ERP Â· Saudi & Gulf Region','font-size:13px;color:#64748B;');
console.log('%cDeveloped by Mohamed Salah | wa.me/201113903070','font-size:11px;color:#00897B;');
</script>
</body>
</html>
